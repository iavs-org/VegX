<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to use the VegX R package • VegX</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to use the VegX R package">
<meta property="og:description" content="VegX">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VegX</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/PackageTutorial.html">How to use the VegX R package</a>
    </li>
    <li>
      <a href="../articles/VegXStandard.html">The Veg-X exchange standard</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="PackageTutorial_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How to use the VegX R package</h1>
                        <h4 class="author">IAVS Ecoinformatics Working Group</h4>
            
            <h4 class="date">2021-12-16</h4>
      
      
      <div class="hidden name"><code>PackageTutorial.Rmd</code></div>

    </div>

    
    
<div id="about-this-tutorial" class="section level2">
<h2 class="hasAnchor">
<a href="#about-this-tutorial" class="anchor"></a>About this tutorial</h2>
<p>In this vignette you will learn how to use the <strong>VegX R package</strong> to map, integrate and harmonize vegetation data using the Veg-X standard (v. 2.0). For the examples, we use the data sets provided in the package. If you do not know what the Veg-X standard is, please refer to vignette <strong>The Veg-X exchange standard</strong>. Here we refer to elements of the Veg-X standard. Readers should refer to the same vignette to understand the definition of these elements and their logical relationships.</p>
</div>
<div id="package-users-and-their-main-interests" class="section level2">
<h2 class="hasAnchor">
<a href="#package-users-and-their-main-interests" class="anchor"></a>Package users and their main interests</h2>
<p>We envisage two different kinds of users of the VegX package:</p>
<ul>
<li>
<strong>Vegetation data providers</strong>: These are people that are in possession of plot vegetation data (i.e. plot database managers or people having their own spread sheets) and get requests to share its data with third parties. Data providers would benefit from VegX package, in that they would perform the mapping of their source data into Veg-X only once, and then they would send the Veg-X file to any party requesting access to data. The functions most interesting to data providers are:
<ul>
<li>Create new VegX documents</li>
<li>Add information about plot location, plot shape and site characteristics.</li>
<li>Add vegetation observations of different kinds: individual plants, aggregated cover values, strata observations…</li>
<li>Add site observations (e.g. abiotic measurements).</li>
<li>Provide information about the taxon concepts related to organism identifications.</li>
<li>Provide information about the research project and contact information.</li>
<li>Write Veg-X XML files or other supported export formats.</li>
</ul>
</li>
<li>
<strong>Vegetation data integrators</strong>: These are people interested in gathering data from different sources, for the sake of compiling a new vegetation plot data base or conducting analyses based on integrated data sets. The functions most interesting to data integrators are:
<ul>
<li>Load Veg-X XML files.</li>
<li>Merge several Veg-X objects from different sources.</li>
<li>Assess the degree of compatibility of the different source data.</li>
<li>Harmonize measurement units and taxonomic nomenclature across data sets.</li>
<li>Generate new observations at a given level of vegetation resolution by aggregating data at a lower level (e.g. from individual tree diameters to basal area estimates).</li>
<li>Export data into formats suitable for analysis.</li>
</ul>
</li>
</ul>
</div>
<div id="installing-the-package-and-loading-source-data" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-the-package-and-loading-source-data" class="anchor"></a>Installing the package and loading source data</h2>
<p>The <strong>VegX package</strong> is currently distributed from <a href="https://github.com">GitHub</a>. To install it, you should have package <code>devtools</code> installed and use the following command: <code><a href="https://devtools.r-lib.org/reference/remote-reexports.html">devtools::install_github("iavs-org/VegX", build_vignettes=TRUE)</a></code>. Assuming that the package is already installed you begin by loading it, which results in the required package <em>XML</em> also being loaded:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">VegX</span><span class="op">)</span></code></pre></div>
<p>User’s of the VegX package are expected to know how import their source data into R, either using a database connection or by reading files in diverse formats (e.g. txt, csv, xlsx, …). For the examples of this manual, we will use three data sets that were extracted from the <a href="https://nvs.landcareresearch.co.nz/">New Zealand National Vegetation Survey (NVS) Databank</a>. These are subsets of the original datasets prepared for demonstration purposes only.</p>
<ul>
<li>
<strong>Mokihinui forest</strong>: Forest and riparian data from 5 plots from the west coast of South Island (New Zealand). The data comprises i) site information from each plot; ii) cover scores of taxa within height strata; and iii) dbh measurement of individual trees.</li>
<li>
<strong>Mt Fyffe forest</strong>: Forest data from five permanent plots from the east coast of South Island (New Zealand). The data comprises i) site information from each plot; ii) cover scores of taxa within height strata; iii) dbh measurement of individual trees within subplots that fully partition the permanent plot; iv) counts of saplings within subplots that fully partition the permanent plot; and v) counts of seedlings within height strata within subplots that sample the permanent plot. Two full measurements of the permanent plots are provided.</li>
<li>
<strong>Takitimu grassland</strong>: Alpine grassland data from 5 plots from the southern South Island (New Zealand). The data comprises i) site information from each plot; ii) frequency values for plant taxa based on observations within subplots along transects; iii) groundcover; iv) disturbance.</li>
</ul>
<p>Each of the three data sets contains different tables, corresponding to plot location, site observations, taxon observations, … For simplicity, we reduced the number of plots in each example data set to five, although some data sets contain subplots. As the three data sets are included with the package, we load the data from the three data sets into the R workspace using:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mokihinui</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mtfyffe</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">takitimu</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "moki_dia"            "moki_loc"            "moki_lookup"        
##  [4] "moki_site"           "moki_str"            "moki_tcv"           
##  [7] "mtfyffe_counts"      "mtfyffe_dia"         "mtfyffe_disturbance"
## [10] "mtfyffe_groundcover" "mtfyffe_loc"         "mtfyffe_lookup"     
## [13] "mtfyffe_site"        "taki_disturbance"    "taki_freq"          
## [16] "taki_groundcover"    "taki_loc"            "taki_lookup"        
## [19] "taki_site"</code></pre>
</div>
<div id="creating-a-new-veg-x-document" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-new-veg-x-document" class="anchor"></a>Creating a new Veg-X document</h2>
<p>Before mapping any data to the Veg-X standard, we need to create a new (empty) document for each data set, using <code><a href="../reference/newVegX.html">newVegX()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">moki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/newVegX.html">newVegX</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">mtfyffe_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/newVegX.html">newVegX</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">taki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/newVegX.html">newVegX</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>The output from <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> command reveals that a Veg-X document is defined in R using a S4 class, each of the different <em>slots</em> being vectors of the main elements of the Veg-X document:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">moki_vegx</span><span class="op">)</span></code></pre></div>
<pre><code>## An object of class "VegX"
## Slot "VegXVersion":
## [1] "2.0.0"
## 
## Slot "parties":
## list()
## 
## Slot "literatureCitations":
## list()
## 
## Slot "methods":
## list()
## 
## Slot "attributes":
## list()
## 
## Slot "strata":
## list()
## 
## Slot "surfaceTypes":
## list()
## 
## Slot "organismNames":
## list()
## 
## Slot "taxonConcepts":
## list()
## 
## Slot "organismIdentities":
## list()
## 
## Slot "projects":
## list()
## 
## Slot "plots":
## list()
## 
## Slot "individualOrganisms":
## list()
## 
## Slot "plotObservations":
## list()
## 
## Slot "individualObservations":
## list()
## 
## Slot "aggregateObservations":
## list()
## 
## Slot "stratumObservations":
## list()
## 
## Slot "communityObservations":
## list()
## 
## Slot "siteObservations":
## list()
## 
## Slot "surfaceCoverObservations":
## list()</code></pre>
<p>Printing a Veg-X object will normally result in too much data being shown in the console output. More user-friendly information about the Veg-X object can be obtained using the function <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>, which tell us how many instances we have of each of the main elements:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">moki_vegx</span><span class="op">)</span></code></pre></div>
<pre><code>## ================================================================
##                     Veg-X object (ver 2.0.0)                   
## ----------------------------------------------------------------
## 
##    Projects: 0
## 
##    Plots: 0  [Parent plots: 0 Sub-plots: 0]
## 
##    Individual organisms: 0
## 
##    Organism names: 0
## 
##    Taxon concepts: 0
## 
##    Organism Identities: 0
## 
##    Vegetation strata: 0
## 
##    Surface types: 0
## 
##    Parties: 0
## 
##    Literature citations: 0
## 
##    Methods: 0
## 
##    Plot observations: 0  [in parent plots: 0 in sub-plots: 0]
## 
##    Individual organism observations: 0
## 
##    Aggregated organism observations: 0
## 
##    Stratum observations: 0
## 
##    Community observations: 0
## 
##    Site observations: 0
## 
##    Surface cover observations: 0
## 
## ================================================================</code></pre>
<p>Of course, <code>moki_vegx</code> is now empty (as are the other two VegX objects).</p>
<p>In the following sections we will progressively add content to the VegX objects. When using the VegX package, the order in which we introduce data to VegX documents is not particularly important, as elements are created as needed. Nevertheless, we will introduce the different functions that add data following a logical sequence. Thus, we begin by introducing plot and survey information, followed by observations of individual organisms, taxa, strata, etc. Later sections of the manual deal with functions that facilitate data integration and harmonization.</p>
</div>
<div id="adding-plot-and-survey-data-to-veg-x-documents" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-plot-and-survey-data-to-veg-x-documents" class="anchor"></a>Adding plot and survey data to Veg-X documents</h2>
<table class="table">
<colgroup>
<col width="19%">
<col width="80%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>addPlotObservation()</code></td>
<td>Adds plot observation records to a VegX object from a data table where rows are plot observations.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/addPlotLocations.html">addPlotLocations()</a></code></td>
<td>Adds/replaces static plot location information (spatial coordinates, elevation, place names, …) to plot elements of a VegX object.</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/addPlotGeometries.html">addPlotGeometries()</a></code></td>
<td>Adds/replaces static plot geometry information (plot shape, dimensions, …) to plot elements of a VegX object.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/addSiteCharacteristics.html">addSiteCharacteristics()</a></code></td>
<td>Adds/replaces static site characteristics (topography, geology, …) to plot elements of a VegX object.</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/fillProjectInformation.html">fillProjectInformation()</a></code></td>
<td>Fills the information for a given research project.</td>
</tr>
</tbody>
</table>
<div id="project-plot-and-observation-dates" class="section level3">
<h3 class="hasAnchor">
<a href="#project-plot-and-observation-dates" class="anchor"></a>Project, plot and observation dates</h3>
<p>In this subsection we show how to introduce information about plot names and survey dates. We start with the <strong>Mokinihui forest data set</strong>, by inspecting the data in the data frame <code>moki_site</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">moki_site</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##    PlotID PlotObsID   Plot Subplot                                     Project
## 38 789033   1161630 LGM08r         MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 39 789034   1161631 LGM08r      1Q MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 40 789035   1161632 LGM08r      2Q MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
##    PlotObsCurrentName PlotLocationDescription PlotObsStartDate PlotObsStopDate
## 38             LGM08r  Mokihinui, Lower gorge       2011-02-17      2011-02-17
## 39                 1Q                               2011-02-17      2011-02-17
## 40                 2Q                               2011-02-17      2011-02-17
##    MeanTopHeight MeanTopHeightUnits PlotPermanence PlotObsCanopyPercentage
## 38             3                  m           True                      20
## 39            NA                                                        NA
## 40            NA                                                        NA
##    PlotArea AreaUnits  Shape Altitude AltitudeUnits Drainage
## 38      400         m Square       95             m     Good
## 39      100         m Square       NA                       
## 40      100         m Square       NA                       
##      DrainageTechniqueName AltitudeDatum PlotSlope SlopeUnits PlotTreatment
## 38 Standard Soil Drainage          a.s.l        40    degrees        Normal
## 39                                              NA                         
## 40                                              NA                         
##    PlotAspect AspectDirection PlotObsIsRelocated Physiography
## 38        360              NA                 NA         Face
## 39         NA              NA                 NA             
## 40         NA              NA                 NA             
##    PhysiographyTechniqueName ParentMaterial ParentMaterialTechniqueName
## 38     Standard Physiography             NA                          NA
## 39                                       NA                          NA
## 40                                       NA                          NA
##    PlotRadius RadiusUnits PlotRectangleLength01 PlotRectangleLength02
## 38         NA          NA                    20                    20
## 39         NA          NA                    10                    10
## 40         NA          NA                    10                    10
##    RectangleUnits                    Placement ParentPlotID ParentPlotObsID
## 38              m Objective: Stratified random       789033         1161630
## 39              m                                    789033         1161630
## 40              m                                    789033         1161630
##    ProjectID pH
## 38      2444  7
## 39      2444  7
## 40      2444  7</code></pre>
<p>The data frame has many columns, encompasing both plot shape, site characteirstics, experimental treamtments, etc. The most important columns to parse in the beginning are <code>Plot</code>, <code>Subplot</code> and <code>PlotObsStartDate</code>, because these specify the space and time context of the vegetation observations. Other columns specify identifiers (IDs), but these are specific to the source data base. As Veg-X documents have their own internal IDs, it is not necessary to import the source identifiers.</p>
<p>To import data into Veg-X documents, we almost always need a <strong>mapping</strong> <em>between the names of elements in the Veg-X standard and the names of columns in the data table used as input</em>. For example, in the following code we define that column <code>"Project"</code> in the source data table contains the information about the <em>projectTitle</em> in Veg-X, column <code>"Plot"</code> contains the information about the <em>plotName</em> element, and so on:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>projectTitle <span class="op">=</span> <span class="st">"Project"</span>, plotName <span class="op">=</span> <span class="st">"Plot"</span>, subPlotName <span class="op">=</span> <span class="st">"Subplot"</span>,
               obsStartDate <span class="op">=</span> <span class="st">"PlotObsStartDate"</span>, obsEndDate <span class="op">=</span> <span class="st">"PlotObsStopDate"</span><span class="op">)</span></code></pre></div>
<p>Once the mapping is defined, we can import the data using <code><a href="../reference/addPlotObservations.html">addPlotObservations()</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">moki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addPlotObservations.html">addPlotObservations</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="va">moki_site</span>, mapping <span class="op">=</span> <span class="va">mapping</span><span class="op">)</span></code></pre></div>
<pre><code>##  1 project(s) parsed, 1 new project(s) added.
##  25 plot(s) parsed, 25 new plot(s) added.
##  25 plot observation(s) parsed, 25 new plot observation(s) added.</code></pre>
<p>The console output of the add function informs us of the steps that took place and the modifications of our Veg-X R object (note that we could store the result in a different object instead of replacing <code>moki_vegx</code>). 25 plots were identified, all belonging to the same research project, and one plot observation was read for each plot. If we again call the <code>summary</code> function we will see a change in the number of data elements:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">moki_vegx</span><span class="op">)</span></code></pre></div>
<pre><code>## ================================================================
##                     Veg-X object (ver 2.0.0)                   
## ----------------------------------------------------------------
## 
##    Projects: 1
##       1. MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 
##    Plots: 25  [Parent plots: 5 Sub-plots: 20]
## 
##    Individual organisms: 0
## 
##    Organism names: 0
## 
##    Taxon concepts: 0
## 
##    Organism Identities: 0
## 
##    Vegetation strata: 0
## 
##    Surface types: 0
## 
##    Parties: 0
## 
##    Literature citations: 0
## 
##    Methods: 0
## 
##    Plot observations: 25  [in parent plots: 5 in sub-plots: 20]
## 
##    Individual organism observations: 0
## 
##    Aggregated organism observations: 0
## 
##    Stratum observations: 0
## 
##    Community observations: 0
## 
##    Site observations: 0
## 
##    Surface cover observations: 0
## 
## ================================================================</code></pre>
<p>Note that among the 25 plots there are 20 sub-plots (i.e. 4 quadrants for each parent plot). If we want to inspect, at any time, the content of a Veg-X object in more detail, we can use the function <code><a href="../reference/showElementTable.html">showElementTable()</a></code>, indicating which of the main Veg-X elements we want to inspect:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"plotObservation"</span><span class="op">)</span>,<span class="fl">6</span><span class="op">)</span></code></pre></div>
<pre><code>##    plotName obsStartDate obsEndDate                                projectTitle
## 1    LGM08r   2011-02-17 2011-02-17 MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 2 LGM08r_1Q   2011-02-17 2011-02-17 MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 3 LGM08r_2Q   2011-02-17 2011-02-17 MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 4 LGM08r_3Q   2011-02-17 2011-02-17 MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 5 LGM08r_4Q   2011-02-17 2011-02-17 MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 6    LGM16l   2011-02-15 2011-02-15 MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011</code></pre>
<p>When sub-plots are added to a VegX object, the package automatically names them by concatenating the name of the plot with the name of the subplot, with an underscore ’_’ to separate both strings.</p>
<p>Let’s now read plots and plot observations for the <strong>Mt Fyffe forest data set</strong>. Since it comes from the same vegetation data base (NVS), the data tables have similar column names and we will not show them again. In this case, however, there is no information about the sampling end date, only the start date. We modify our mapping accordingly and we call <code><a href="../reference/addPlotObservations.html">addPlotObservations()</a></code> :</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>projectTitle <span class="op">=</span> <span class="st">"Project"</span>, plotName <span class="op">=</span> <span class="st">"Plot"</span>, subPlotName <span class="op">=</span> <span class="st">"Subplot"</span>, 
               obsStartDate <span class="op">=</span> <span class="st">"PlotObsStartDate"</span><span class="op">)</span>
<span class="va">mtfyffe_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addPlotObservations.html">addPlotObservations</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span>, <span class="va">mtfyffe_site</span>, <span class="va">mapping</span><span class="op">)</span></code></pre></div>
<pre><code>##  2 project(s) parsed, 2 new project(s) added.
##  165 plot(s) parsed, 165 new plot(s) added.
##  326 plot observation(s) parsed, 326 new plot observation(s) added.</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span><span class="op">)</span></code></pre></div>
<pre><code>## ================================================================
##                     Veg-X object (ver 2.0.0)                   
## ----------------------------------------------------------------
## 
##    Projects: 2
##       1. FYFFE, MOUNT FOREST 1980
##       2. FYFFE, MOUNT FOREST 2007-2008
## 
##    Plots: 165  [Parent plots: 4 Sub-plots: 161]
## 
##    Individual organisms: 0
## 
##    Organism names: 0
## 
##    Taxon concepts: 0
## 
##    Organism Identities: 0
## 
##    Vegetation strata: 0
## 
##    Surface types: 0
## 
##    Parties: 0
## 
##    Literature citations: 0
## 
##    Methods: 0
## 
##    Plot observations: 326  [in parent plots: 8 in sub-plots: 318]
## 
##    Individual organism observations: 0
## 
##    Aggregated organism observations: 0
## 
##    Stratum observations: 0
## 
##    Community observations: 0
## 
##    Site observations: 0
## 
##    Surface cover observations: 0
## 
## ================================================================</code></pre>
<p>In this source data set there are many more sub-plots for each parent plot, and each plot was visited twice (in 1980 and the austral summer of 2007-2008). Moreover, each survey corresponds to a different project. Veg-X does not require projects to be equated to surveys, but this data set is structured this way. We now turn our attention to the <strong>Takitimu grassland data set</strong>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>projectTitle <span class="op">=</span> <span class="st">"Project"</span>, plotName <span class="op">=</span> <span class="st">"Plot"</span>, subPlotName <span class="op">=</span> <span class="st">"Subplot"</span>, 
               obsStartDate <span class="op">=</span> <span class="st">"PlotObsStartDate"</span><span class="op">)</span>
<span class="va">taki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addPlotObservations.html">addPlotObservations</a></span><span class="op">(</span><span class="va">taki_vegx</span>, <span class="va">taki_site</span>, <span class="va">mapping</span><span class="op">)</span></code></pre></div>
<pre><code>##  1 project(s) parsed, 1 new project(s) added.
##  5 plot(s) parsed, 5 new plot(s) added.
##  5 plot observation(s) parsed, 5 new plot observation(s) added.</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">taki_vegx</span><span class="op">)</span></code></pre></div>
<pre><code>## ================================================================
##                     Veg-X object (ver 2.0.0)                   
## ----------------------------------------------------------------
## 
##    Projects: 1
##       1. TAKITIMU GRASSLAND 1968-1969
## 
##    Plots: 5  [Parent plots: 5 Sub-plots: 0]
## 
##    Individual organisms: 0
## 
##    Organism names: 0
## 
##    Taxon concepts: 0
## 
##    Organism Identities: 0
## 
##    Vegetation strata: 0
## 
##    Surface types: 0
## 
##    Parties: 0
## 
##    Literature citations: 0
## 
##    Methods: 0
## 
##    Plot observations: 5  [in parent plots: 5 in sub-plots: 0]
## 
##    Individual organism observations: 0
## 
##    Aggregated organism observations: 0
## 
##    Stratum observations: 0
## 
##    Community observations: 0
## 
##    Site observations: 0
## 
##    Surface cover observations: 0
## 
## ================================================================</code></pre>
<p>According to this summary, this third data set contains again 5 plots, but with no sub-plots, so even though we specified a mapping for sub-plots, there were no sub-plots in the source data table to populate the VegX object.</p>
</div>
<div id="project-information" class="section level3">
<h3 class="hasAnchor">
<a href="#project-information" class="anchor"></a>Project information</h3>
<p>In the previous subsection, we specified a mapping for research project titles, and this lead to the creation of <em>project</em> elements in Veg-X documents. However, we did not introduce any data describing the project:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"project"</span><span class="op">)</span></code></pre></div>
<pre><code>##                            title
## 1 MOKIHINUI HYDRO PROPOSAL - ...</code></pre>
<p>Veg-X package provides the function <code><a href="../reference/fillProjectInformation.html">fillProjectInformation()</a></code> to fill project data. It can be used to fill the data for an existing project (identified by its title) or to define a new project. In this case the data is introduced directly as text to the parameters of the function, instead of being read from a data frame. As an example, we provide the information for the project that led to the collection of data in the <strong>Mokihinui</strong> forest:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">moki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/fillProjectInformation.html">fillProjectInformation</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011"</span>,
              personnel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>contributor <span class="op">=</span> <span class="st">"Susan K. Wiser"</span><span class="op">)</span>,
              abstract <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Characterise the forest and riparian vegetation"</span>,
                               <span class="st">"in the lower Mokihinui gorge,"</span>,
                               <span class="st">"and compare this with the vegetation"</span>,
                               <span class="st">"in (a) North Branch gorge of Mokihinui"</span>,
                               <span class="st">"and (b) Karamea catchment."</span><span class="op">)</span>,
             studyAreaDescription <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Mokihinui and Karamea catchments."</span>,
                                          <span class="st">" Forest riparian habitat."</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  1 new party(ies) added to the document as individuals.</code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"project"</span><span class="op">)</span></code></pre></div>
<pre><code>##                            title                       abstract
## 1 MOKIHINUI HYDRO PROPOSAL - ... Characterise the forest and...
##             studyAreaDescription
## 1 Mokihinui and Karamea catch...</code></pre>
<p>Note that filling the information about the project led to the definition of personnel involved in the project. In the Veg-X standard any individual/organization/position involved in the creation of a data set is stored in a <em>party</em> element. We may fill contact information for <em>party</em> elements using the function <code><a href="../reference/fillPartyInformation.html">fillPartyInformation()</a></code>.</p>
</div>
<div id="plot-coordinates" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-coordinates" class="anchor"></a>Plot coordinates</h3>
<p>The next piece of information we will introduce are the geographic locations of plots (sampling dates were already mapped with <code><a href="../reference/addPlotObservations.html">addPlotObservations()</a></code>). We thus take a look at <code>moki_loc</code> data frame:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">moki_loc</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##    AbsoluteCoordID   Plot Subplot                                     Project
## 7           201568 LGM45h      NA MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 11          201531 LGM08r      NA MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 14          201561 LGM38h      NA MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
##                     Type AbsoluteCoordXEastLong AbsoluteCoordYNorthLat    Datum
## 7  Grid Coordinate (map)                2429288                5960763 NZGD1949
## 11 Grid Coordinate (map)                2438288                5962438 NZGD1949
## 14 Grid Coordinate (map)                2431238                5962363 NZGD1949
##    MapProjection MapSeries MapSheet                 GPS Method
## 7           NZMG  NZMS 260     L28  Garmin GPSMap 60CSX    GPS
## 11          NZMG  NZMS 260     L28  Garmin GPSMap 60CSX    GPS
## 14          NZMG  NZMS 260     L28  Garmin GPSMap 60CSX    GPS
##                 Source EastingMG NorthingMG Longitude Latitude PrecisionMetres
## 7  Original Coordinate   2429288    5960763  172.0326 -41.5559               5
## 11 Original Coordinate   2438288    5962438  172.1407 -41.5417               5
## 14 Original Coordinate   2431238    5962363  172.0562 -41.5417               5
##    PrecisionShape ParentPlotID ParentPlotObsID PlotCoordinateID PlotObsID
## 7          Circle       789218         1161815           287136   1161815
## 11         Circle       789033         1161630           287099   1161630
## 14         Circle       789183         1161780           287129   1161780
##    ProjectID
## 7       2444
## 11      2444
## 14      2444</code></pre>
<p>Locations are expressed using different coordinate systems, but the easiest and more common way of exchanging geographic information is by using latitude and longitude. Hence, we define a new mapping and use the function <code><a href="../reference/addPlotLocations.html">addPlotLocations()</a></code>:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plotName <span class="op">=</span> <span class="st">"Plot"</span>, x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span><span class="op">)</span>
<span class="va">moki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addPlotLocations.html">addPlotLocations</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="va">moki_loc</span>, <span class="va">mapping</span>, 
                             proj4string <span class="op">=</span> <span class="st">"+proj=longlat +datum=WGS84"</span><span class="op">)</span></code></pre></div>
<pre><code>##  5 plot(s) parsed, 0 new plot(s) added.
##  5 record(s) parsed.</code></pre>
<p>When defining the mapping <code>x</code>and <code>y</code>are used to map coordinates. We should also include <code>plotName</code>, because otherwise the function does not know how to match coordinates with the plots already defined in <code>moki_vegx</code> (<code>subPlotName</code> should be included if coordinates are available for subplots). Parameter <code>proj4string</code> is used to supply the spatial reference system of the coordinates. The console output indicates that no new plots have been added (they were previously defined), but they would if we had started populating an empty Veg-X object using <code><a href="../reference/addPlotLocations.html">addPlotLocations()</a></code>. We can inspect the data recently entered using the following command:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"plot"</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##    plotName   coordX   coordY           spatialReference relatedPlotName
## 1    LGM08r 172.1407 -41.5417 +proj=longlat +datum=WGS84            &lt;NA&gt;
## 2 LGM08r_1Q       NA       NA                       &lt;NA&gt;          LGM08r
## 3 LGM08r_2Q       NA       NA                       &lt;NA&gt;          LGM08r
##   plotRelationship
## 1             &lt;NA&gt;
## 2          subplot
## 3          subplot</code></pre>
<p>When calling <code><a href="../reference/showElementTable.html">showElementTable()</a></code> for plot elements we are showing the plot/sub-plot relationships. Note that sub-plots have no explicit coordinates associated to them (they are not given in <code>moki_loc</code>). It is up to the user to provide them in the source data. Using the same mapping we can parse the coordinates of the <strong>Mt Fyffe forest data set</strong>:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mtfyffe_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addPlotLocations.html">addPlotLocations</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span>, <span class="va">mtfyffe_loc</span>, <span class="va">mapping</span><span class="op">)</span></code></pre></div>
<pre><code>##  4 plot(s) parsed, 0 new plot(s) added.
##  8 record(s) parsed.</code></pre>
<p>In this example, 8 records were parsed, but coordinates are availble for four plots only. Coordinate records are duplicated in <code>mtfyffe_loc</code>, because they are provided independently for each survey. The function <code><a href="../reference/addPlotLocations.html">addPlotLocations()</a></code> will only keep the most recently read location records of each plot. Finally, we parse plot coordinates for the <strong>Takikimu grassland data set</strong>, realizing that they are missing for three of the plots.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">taki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addPlotLocations.html">addPlotLocations</a></span><span class="op">(</span><span class="va">taki_vegx</span>, <span class="va">taki_loc</span>, <span class="va">mapping</span><span class="op">)</span></code></pre></div>
<pre><code>##  5 plot(s) parsed, 0 new plot(s) added.
##  5 record(s) parsed.
##  3 record(s) with missing value(s) not added.</code></pre>
<p>The function <code><a href="../reference/addPlotLocations.html">addPlotLocations()</a></code> accepts coordinates in any spatial reference system (which is specified using the parameter <code>proj4string</code>). Setting <code>toWGS84 = TRUE</code> will indicate to the function that it should attempt to translate the input coordinates into longitude and latitude, but this was not required in our examples.</p>
</div>
<div id="plot-elevation" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-elevation" class="anchor"></a>Plot elevation</h3>
<p>While <code>x</code> and <code>y</code> specify horizontal plot position, the vertical position of a plot is specified using elevation (normally above sea level). Since plot elevation is a <strong>measurement</strong>, it is important to specify a <strong>measurement method</strong> (i.e. instruments) and a <strong>measurement scale</strong> (i.e. measurement units) because this metadata decreases potential errors when pooling data from different sources. In the Veg-X standard, this information is specified via defining <em>method</em> and <em>attribute</em> elements, whereas the VegX package has a S4 class named <code>VegXMethod</code> that encapsulates both things. Users can define their own methods, but the package provides function <code><a href="../reference/predefinedMeasurementMethod.html">predefinedMeasurementMethod()</a></code> to easily define methods for the most common variables. For example, we can define the measurement for elevation in meters above sea level using:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">elevMethod</span> <span class="op">=</span> <span class="fu"><a href="../reference/predefinedMeasurementMethod.html">predefinedMeasurementMethod</a></span><span class="op">(</span><span class="st">"Elevation/m"</span><span class="op">)</span></code></pre></div>
<p>Plot elevation is added to Veg-X documents using <code><a href="../reference/addPlotLocations.html">addPlotLocations()</a></code> as before. However, in our Mokihinui data set elevation is included in the data frame <code>moki_site</code> (and not <code>moki_loc</code>), so we could not add it using the same call that we used for plot coordinates. Having our elevation method defined, we use again:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plotName <span class="op">=</span> <span class="st">"Plot"</span>, elevation <span class="op">=</span> <span class="st">"Altitude"</span><span class="op">)</span>
<span class="va">moki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addPlotLocations.html">addPlotLocations</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="va">moki_site</span>, <span class="va">mapping</span>, 
                             methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>elevation <span class="op">=</span> <span class="va">elevMethod</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'Elevation/m' added for 'elevation'.
##  5 plot(s) parsed, 0 new plot(s) added.
##  25 record(s) parsed.
##  20 record(s) with missing value(s) not added.</code></pre>
<p>Only the parent plots have elevation data (i.e., the records of sub-plots are missing). If we inspect again the <em>plot</em> elements of our document we find that elevation data has been added to plot coordinates:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"plot"</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##    plotName   coordX   coordY           spatialReference elevation_method
## 1    LGM08r 172.1407 -41.5417 +proj=longlat +datum=WGS84      Elevation/m
## 2 LGM08r_1Q       NA       NA                       &lt;NA&gt;             &lt;NA&gt;
## 3 LGM08r_2Q       NA       NA                       &lt;NA&gt;             &lt;NA&gt;
##   elevation_value relatedPlotName plotRelationship
## 1              95            &lt;NA&gt;             &lt;NA&gt;
## 2              NA          LGM08r          subplot
## 3              NA          LGM08r          subplot</code></pre>
<p>Analogous calls to <code><a href="../reference/addPlotLocations.html">addPlotLocations()</a></code> can be made to fill elevation data for the <strong>Mt Fyffe forest</strong> and the <strong>Takitimu grassland</strong> data sets:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mtfyffe_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addPlotLocations.html">addPlotLocations</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span>, <span class="va">mtfyffe_site</span>, <span class="va">mapping</span>,
                                methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>elevation <span class="op">=</span> <span class="va">elevMethod</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'Elevation/m' added for 'elevation'.
##  4 plot(s) parsed, 0 new plot(s) added.
##  326 record(s) parsed.
##  318 record(s) with missing value(s) not added.</code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">taki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addPlotLocations.html">addPlotLocations</a></span><span class="op">(</span><span class="va">taki_vegx</span>, <span class="va">taki_site</span>, <span class="va">mapping</span>, 
                             methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>elevation <span class="op">=</span> <span class="st">"Elevation/m"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'Elevation/m' added for 'elevation'.
##  5 plot(s) parsed, 0 new plot(s) added.
##  5 record(s) parsed.</code></pre>
<p>Note that in this case we specified the method for elevation using a string directly. This avoids having to call function <code><a href="../reference/predefinedMeasurementMethod.html">predefinedMeasurementMethod()</a></code>.</p>
</div>
<div id="plot-geometry" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-geometry" class="anchor"></a>Plot geometry</h3>
<p>By plot geometry, we refer to plot area, shape and dimensions. Veg-X allows different plot shapes (circle, rectangle, line or polygon), and each plot shape implies different dimensions. Plot geometry is specified using function <code><a href="../reference/addPlotGeometries.html">addPlotGeometries()</a></code> and, analogously to <code>addPlotLocation()</code>, the function will replace any previous information regarding geometry. We start by looking at the plot geometry fields in the <strong>Mokihinui forest data set</strong> table <code>moki_site</code>:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">moki_site</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "PlotID"                      "PlotObsID"                  
##  [3] "Plot"                        "Subplot"                    
##  [5] "Project"                     "PlotObsCurrentName"         
##  [7] "PlotLocationDescription"     "PlotObsStartDate"           
##  [9] "PlotObsStopDate"             "MeanTopHeight"              
## [11] "MeanTopHeightUnits"          "PlotPermanence"             
## [13] "PlotObsCanopyPercentage"     "PlotArea"                   
## [15] "AreaUnits"                   "Shape"                      
## [17] "Altitude"                    "AltitudeUnits"              
## [19] "Drainage"                    "DrainageTechniqueName"      
## [21] "AltitudeDatum"               "PlotSlope"                  
## [23] "SlopeUnits"                  "PlotTreatment"              
## [25] "PlotAspect"                  "AspectDirection"            
## [27] "PlotObsIsRelocated"          "Physiography"               
## [29] "PhysiographyTechniqueName"   "ParentMaterial"             
## [31] "ParentMaterialTechniqueName" "PlotRadius"                 
## [33] "RadiusUnits"                 "PlotRectangleLength01"      
## [35] "PlotRectangleLength02"       "RectangleUnits"             
## [37] "Placement"                   "ParentPlotID"               
## [39] "ParentPlotObsID"             "ProjectID"                  
## [41] "pH"</code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">moki_site</span><span class="op">$</span><span class="va">Shape</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Square 
##     25</code></pre>
<p>After realizing that plot/subplot shapes are rectangular and both length and width are available, we define the following mapping for rectangular (or square) plots:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plotName <span class="op">=</span> <span class="st">"Plot"</span>, subPlotName <span class="op">=</span> <span class="st">"Subplot"</span>,
               area <span class="op">=</span> <span class="st">"PlotArea"</span>, shape <span class="op">=</span> <span class="st">"Shape"</span>,
               length <span class="op">=</span> <span class="st">"PlotRectangleLength01"</span>, width <span class="op">=</span> <span class="st">"PlotRectangleLength02"</span><span class="op">)</span></code></pre></div>
<p>Like <strong>elevation</strong>, plot area and plot dimensions are <strong>measurements</strong> so we need to define them. We are now ready to import plot geometry using <code><a href="../reference/addPlotGeometries.html">addPlotGeometries()</a></code>, where we specify both the mapping and the list of methods corresponding to the Veg-X element names of the mapping (i.e. <code>area</code>, <code>length</code> and <code>width</code> for rectangular plots):</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">moki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addPlotGeometries.html">addPlotGeometries</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="va">moki_site</span>, <span class="va">mapping</span>,
              <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>area <span class="op">=</span> <span class="st">"Plot area/m2"</span>, width <span class="op">=</span> <span class="st">"Plot dimension/m"</span>, length <span class="op">=</span> <span class="st">"Plot dimension/m"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'Plot area/m2' added for 'area'.
##  Measurement method 'Plot dimension/m' added for 'width'.
##  Measurement method 'Plot dimension/m' for 'length' already included.
##  25 plot(s) parsed, 0 new plot(s) added.
##  25 record(s) parsed.</code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"plot"</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##    plotName     shape    length_method length_value     width_method
## 1    LGM08r rectangle Plot dimension/m           20 Plot dimension/m
## 2 LGM08r_1Q rectangle Plot dimension/m           10 Plot dimension/m
## 3 LGM08r_2Q rectangle Plot dimension/m           10 Plot dimension/m
##   width_value   coordX   coordY           spatialReference elevation_method
## 1          20 172.1407 -41.5417 +proj=longlat +datum=WGS84      Elevation/m
## 2          10       NA       NA                       &lt;NA&gt;             &lt;NA&gt;
## 3          10       NA       NA                       &lt;NA&gt;             &lt;NA&gt;
##   elevation_value relatedPlotName plotRelationship
## 1              95            &lt;NA&gt;             &lt;NA&gt;
## 2              NA          LGM08r          subplot
## 3              NA          LGM08r          subplot</code></pre>
<p>Like before, no new plots were added, as previous call functions had already defined them. In the call to <code><a href="../reference/showElementTable.html">showElementTable()</a></code> we have now the plot geometry added to the plot location and plot/subplot relationships. Importing plot geometry for the <strong>Takitimu grassland data</strong> set is analogous:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">taki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addPlotGeometries.html">addPlotGeometries</a></span><span class="op">(</span><span class="va">taki_vegx</span>, <span class="va">taki_site</span>, <span class="va">mapping</span>,
              <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>area <span class="op">=</span> <span class="st">"Plot area/m2"</span>, width <span class="op">=</span> <span class="st">"Plot dimension/m"</span>, length <span class="op">=</span> <span class="st">"Plot dimension/m"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'Plot area/m2' added for 'area'.
##  Measurement method 'Plot dimension/m' added for 'width'.
##  Measurement method 'Plot dimension/m' for 'length' already included.
##  5 plot(s) parsed, 0 new plot(s) added.
##  5 record(s) parsed.</code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">taki_vegx</span>, <span class="st">"plot"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##            plotName     shape    length_method length_value     width_method
## 1 WB2 2 (WB2 2_TRA) rectangle Plot dimension/m           20 Plot dimension/m
## 2   R1 1 (R1 1_TRA) rectangle Plot dimension/m           20 Plot dimension/m
## 3   T2 2 (T2 2_TRA) rectangle Plot dimension/m           20 Plot dimension/m
## 4   T1 2 (T1 2_TRA) rectangle Plot dimension/m           20 Plot dimension/m
## 5   R3 1 (R3 1_TRA) rectangle Plot dimension/m           20 Plot dimension/m
##   width_value   coordX   coordY elevation_method elevation_value
## 1          20 167.9438 -45.6321      Elevation/m            1463
## 2          20       NA       NA      Elevation/m            1097
## 3          20       NA       NA      Elevation/m             914
## 4          20       NA       NA      Elevation/m            1097
## 5          20 167.8307 -45.7138      Elevation/m            1067</code></pre>
<p>In the case of <strong>Mt Fyffe forest data set</strong>, shape is missing for many of plots. Other plots are circular but <em>radius</em> is not defined in the <code>mtfyffe_site</code> data frame.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">mtfyffe_site</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "PlotID"                    "PlotObsID"                
##  [3] "Plot"                      "Subplot"                  
##  [5] "Project"                   "PlotObsCurrentName"       
##  [7] "PlotLocationDescription"   "PlotObsStartDate"         
##  [9] "PlotObsStopDate"           "MeanTopHeight"            
## [11] "MeanTopHeightUnits"        "PlotPermanence"           
## [13] "PlotArea"                  "AreaUnits"                
## [15] "Shape"                     "Altitude"                 
## [17] "AltitudeUnits"             "Drainage"                 
## [19] "DrainageTechniqueName"     "PlotSlope"                
## [21] "SlopeUnits"                "PlotTreatment"            
## [23] "PlotAspect"                "Physiography"             
## [25] "PhysiographyTechniqueName" "Placement"                
## [27] "ParentPlotID"              "ParentPlotObsID"          
## [29] "ProjectID"</code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">mtfyffe_site</span><span class="op">$</span><span class="va">Shape</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##        Circle 
##    135    191</code></pre>
<p>Hence, we define the following mapping, and a call <code><a href="../reference/addPlotGeometries.html">addPlotGeometries()</a></code> produces the following result:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plotName <span class="op">=</span> <span class="st">"Plot"</span>, subPlotName <span class="op">=</span> <span class="st">"Subplot"</span>,
               area <span class="op">=</span> <span class="st">"PlotArea"</span>, shape <span class="op">=</span> <span class="st">"Shape"</span><span class="op">)</span>
<span class="va">mtfyffe_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addPlotGeometries.html">addPlotGeometries</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span>, <span class="va">mtfyffe_site</span>, <span class="va">mapping</span>,
                                 <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>area <span class="op">=</span> <span class="st">"Plot area/m2"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'Plot area/m2' added for 'area'.
##  165 plot(s) parsed, 0 new plot(s) added.
##  326 record(s) parsed.
##  1 record(s) with missing value(s) not added.</code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span>, <span class="st">"plot"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##   plotName   coordX   coordY elevation_method elevation_value relatedPlotName
## 1      6 4 173.6370 -42.3276      Elevation/m             480            &lt;NA&gt;
## 2     12 1 173.6479 -42.2728      Elevation/m             575            &lt;NA&gt;
## 3     14 2 173.6532 -42.2563      Elevation/m             879            &lt;NA&gt;
##   plotRelationship shape
## 1             &lt;NA&gt;  &lt;NA&gt;
## 2             &lt;NA&gt;  &lt;NA&gt;
## 3             &lt;NA&gt;  &lt;NA&gt;</code></pre>
</div>
<div id="other-static-site-characteristics" class="section level3">
<h3 class="hasAnchor">
<a href="#other-static-site-characteristics" class="anchor"></a>Other static site characteristics</h3>
<p>To finish with static plot information, the next data we should add to our Veg-X documents is plot topography. This can be done using function <code><a href="../reference/addSiteCharacteristics.html">addSiteCharacteristics()</a></code>, which also allows introducing other site attributes that are considered static in time for the time scales of vegetation dynamics (e.g. geological parent material). Having inspected data frame <code>moki_site</code> before makes us suspect that an appropriate mapping is:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sitemapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plotName <span class="op">=</span> <span class="st">"Plot"</span>, subPlotName <span class="op">=</span> <span class="st">"Subplot"</span>,
                   slope <span class="op">=</span> <span class="st">"PlotSlope"</span>, aspect <span class="op">=</span> <span class="st">"PlotAspect"</span><span class="op">)</span></code></pre></div>
<p>Since slope and aspect are again <strong>measurements</strong>, we also need to provide methods for them. After checking the units in the source data we are ready to import the data:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">moki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addSiteCharacteristics.html">addSiteCharacteristics</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="va">moki_site</span>, mapping <span class="op">=</span> <span class="va">sitemapping</span>,
                measurementMethods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="st">"Slope/degrees"</span>, aspect <span class="op">=</span> <span class="st">"Aspect/degrees"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'Slope/degrees' added for 'slope'.
##  Measurement method 'Aspect/degrees' added for 'aspect'.
##  25 plot(s) parsed, 0 new plot(s) added.
##  25 record(s) parsed.
##  40 measurement(s) with missing value(s) not added.</code></pre>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"plot"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##    plotName     shape    length_method length_value     width_method
## 1    LGM08r rectangle Plot dimension/m           20 Plot dimension/m
## 2 LGM08r_1Q rectangle Plot dimension/m           10 Plot dimension/m
## 3 LGM08r_2Q rectangle Plot dimension/m           10 Plot dimension/m
##   width_value   coordX   coordY           spatialReference elevation_method
## 1          20 172.1407 -41.5417 +proj=longlat +datum=WGS84      Elevation/m
## 2          10       NA       NA                       &lt;NA&gt;             &lt;NA&gt;
## 3          10       NA       NA                       &lt;NA&gt;             &lt;NA&gt;
##   elevation_value  slope_method slope_value  aspect_method aspect_value
## 1              95 Slope/degrees          40 Aspect/degrees          360
## 2              NA          &lt;NA&gt;          NA           &lt;NA&gt;           NA
## 3              NA          &lt;NA&gt;          NA           &lt;NA&gt;           NA
##   relatedPlotName plotRelationship
## 1            &lt;NA&gt;             &lt;NA&gt;
## 2          LGM08r          subplot
## 3          LGM08r          subplot</code></pre>
<p>Again, no new plots are added, and missing values correspond to subplots. When calling <code><a href="../reference/showElementTable.html">showElementTable()</a></code> the topography information is shown along with the plot information previously added. Since the site data frames for <strong>Mt Fyffe forest</strong> and <strong>Takitimu grassland</strong> data sets have the same structure as that of Mokihinui, adding topography information for the former data sets is rather straightforward:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mtfyffe_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addSiteCharacteristics.html">addSiteCharacteristics</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span>, <span class="va">mtfyffe_site</span>, mapping <span class="op">=</span> <span class="va">sitemapping</span>,
                measurementMethods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="st">"Slope/degrees"</span>, aspect <span class="op">=</span> <span class="st">"Aspect/degrees"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'Slope/degrees' added for 'slope'.
##  Measurement method 'Aspect/degrees' added for 'aspect'.
##  165 plot(s) parsed, 0 new plot(s) added.
##  326 record(s) parsed.
##  636 measurement(s) with missing value(s) not added.</code></pre>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">taki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addSiteCharacteristics.html">addSiteCharacteristics</a></span><span class="op">(</span><span class="va">taki_vegx</span>, <span class="va">taki_site</span>, mapping <span class="op">=</span> <span class="va">sitemapping</span>,
                measurementMethods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="st">"Slope/degrees"</span>, aspect <span class="op">=</span> <span class="st">"Aspect/degrees"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'Slope/degrees' added for 'slope'.
##  Measurement method 'Aspect/degrees' added for 'aspect'.
##  5 plot(s) parsed, 0 new plot(s) added.
##  5 record(s) parsed.</code></pre>
</div>
</div>
<div id="adding-observation-data" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-observation-data" class="anchor"></a>Adding observation data</h2>
<p>In the beginning of the previous section we specified plot observation dates for the plots of our examples, using function <code>addPlotObservation()</code>. While this function defines survey events for plots, it does not add any observation or measurement made on plot visits. In this section we show how to add such information.</p>
<table class="table">
<colgroup>
<col width="19%">
<col width="80%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/addIndividualOrganismObservations.html">addIndividualOrganismObservations()</a></code></td>
<td>Adds individual organism observation records (e.g. tree diameters or heights) to a VegX object.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/addAggregateOrganismObservations.html">addAggregateOrganismObservations()</a></code></td>
<td>Adds aggregate organism observation records (e.g. % cover of a particular taxon) to a VegX object.</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/addStratumObservations.html">addStratumObservations()</a></code></td>
<td>Adds stratum observation records (e.g. % cover of plants in the tree layer) to a VegX object.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/addCommunityObservations.html">addCommunityObservations()</a></code></td>
<td>Adds community observation records (e.g. stand age or total basal area) to a VegX object.</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/addSiteObservations.html">addSiteObservations()</a></code></td>
<td>Adds site observation records (e.g. abiotic measurements such as pH) to a VegX object.</td>
</tr>
<tr class="even">
<td><code><a href="../reference/addSurfaceCoverObservations.html">addSurfaceCoverObservations()</a></code></td>
<td>Adds surface cover observation records (e.g. percent of ground covered by bare soil or rocks) to a VegX object.</td>
</tr>
</tbody>
</table>
<div id="individual-organism-observations" class="section level3">
<h3 class="hasAnchor">
<a href="#individual-organism-observations" class="anchor"></a>Individual organism observations</h3>
<p>First we focus on observations made on individual organisms (e.g. diameter values measured on individual trees). Since individual organisms can be labelled and re-measured in different plot surveys, Veg-X uses the element <em>individualOrganism</em> to keep track of the organism itself. Then, different elements <em>individualOrganismObservations</em> can be used to contain measurements made on the individual organism each time there was an observation of the plot (i.e. each time the plot was revisited). The individual organism (e.g. a particular tree) is uniquely identified using the plot name and an organism label (i.e. a tag on the specimen). Thus, the same label can be repeated in different plots without causing data integrity problems. Individual organisms and their observations are added to Veg-X using the function <code><a href="../reference/addIndividualOrganismObservations.html">addIndividualOrganismObservations()</a></code>. We first show how it works using the data frame <code>moki_dia</code>, which contains diameter measurements for trees in the <strong>Mokihinui forest</strong> data set:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">moki_dia</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##     DiameterID   Plot Subplot                                     Project
## 912    2965105 LGM38h      1Q MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 920    2965112 LGM38h      1Q MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 921    2965114 LGM38h      1Q MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
##     EntryNo ItemCurrentIdentifier Identifier AliveState    MethodName
## 912       1                    NA         NA      Alive Stem Diameter
## 920       8                    NA         NA      Alive Stem Diameter
## 921      10                    NA         NA      Alive Stem Diameter
##     Verbatim.Species TaxonID CurrentTaxonID NVSCode       NVSSpeciesName
## 912           WEIRAC    1747           1747  WEIRAC  Weinmannia racemosa
## 920           COPGRA    2396           2396  COPGRA Coprosma grandifolia
## 921           CYASMI    1146           1146  CYASMI      Cyathea smithii
##     Diameter DiameterValueUnits AssociationNo Association HeightOrLength
## 912     10.6                 cm            NA                         NA
## 920      4.0                 cm            NA                         NA
## 921     11.3                 cm            NA                         NA
##     LinearDimensionUnits ItemObsNote  ItemID ItemObsID ParentPlotID
## 912                   NA             2321109   3016862       789183
## 920                   NA             2321116   3016869       789183
## 921                   NA             2321118   3016871       789183
##     ParentPlotObsID PlotMethodID PlotObsID ProjectID SampleMethodID
## 912         1161780      1392927   1161781      2444          13406
## 920         1161780      1392927   1161781      2444          13406
## 921         1161780      1392927   1161781      2444          13406
##     PlotObsStartDate
## 912       2011-02-20
## 920       2011-02-20
## 921       2011-02-20</code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">moki_dia</span><span class="op">$</span><span class="va">Identifier</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>Note that there is a column called <code>Identifier</code> but no data in it. Fortunately, the data set includes a single survey, so that there is no need to provide labels for individual organisms. Hence, we can define our mapping as follows:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plotName <span class="op">=</span> <span class="st">"Plot"</span>, subPlotName <span class="op">=</span> <span class="st">"Subplot"</span>, obsStartDate <span class="op">=</span> <span class="st">"PlotObsStartDate"</span>,
               taxonName <span class="op">=</span> <span class="st">"NVSSpeciesName"</span>, diameterMeasurement <span class="op">=</span> <span class="st">"Diameter"</span><span class="op">)</span></code></pre></div>
<p>If no mapping is provided for <em>individualOrganismLabel</em>, function <code><a href="../reference/addIndividualOrganismObservations.html">addIndividualOrganismObservations()</a></code> will assume that each record corresponds to a different organism. To define the identity of organisms we can use mapping for either <code>organismName</code> or <code>taxonName</code>. The first option is used to specify names that are not taxa (e.g. “tree #1”, “tree #2”, or morphospecies), while the second option explicitly identifies names as taxa. The call to the function produces the following output:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">moki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addIndividualOrganismObservations.html">addIndividualOrganismObservations</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="va">moki_dia</span>, mapping <span class="op">=</span> <span class="va">mapping</span>,
                                      methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>diameterMeasurement <span class="op">=</span> <span class="st">"DBH/cm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'DBH/cm' added for 'diameterMeasurement'.
##  23 plot(s) parsed, 0 new added.
##  18 plot observation(s) parsed, 0 new added.
##  28 organism names(s) parsed, 28 new added.
##  0 taxon concept(s) parsed, 0 new added.
##  28 organism identitie(s) parsed, 28 new added.
##  0 individual organism(s) parsed, 643 new added.
##  643 record(s) parsed, 643 new individual organism observation(s) added.</code></pre>
<p>where we see that the number of individual organisms is equal to the number of observations. We can inspect the added individual organism observations using:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"individualOrganismObservation"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##    plotName obsStartDate individualOrganismLabel organismIdentityName
## 1 LGM38h_1Q   2011-02-20                    ind1  Weinmannia racemosa
## 2 LGM38h_1Q   2011-02-20                    ind2 Coprosma grandifolia
## 3 LGM38h_1Q   2011-02-20                    ind3      Cyathea smithii
##   diameter_method diameter_value
## 1          DBH/cm           10.6
## 2          DBH/cm            4.0
## 3          DBH/cm           11.3</code></pre>
<p>Note that the column <code>individualOrganismLabel</code> contains labels created by the function itself, by numbering all individuals of each plot. The call to function <code><a href="../reference/addIndividualOrganismObservations.html">addIndividualOrganismObservations()</a></code> also led to the definition of elements <em>organismName</em> (used to store the different organism/taxon names that are used in the Veg-X document) and elements <em>organismIdentity</em> (which define the identity of organisms, as with links to organism names and taxon concepts). Let’s inspect the latter:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"organismIdentity"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##           identityName originalOrganismName taxon
## 1  Weinmannia racemosa  Weinmannia racemosa  TRUE
## 2 Coprosma grandifolia Coprosma grandifolia  TRUE
## 3      Cyathea smithii      Cyathea smithii  TRUE</code></pre>
<p>In this case, the identity is simply the species name coming from the source data, but it could be another name considered nomenclaturally more valid for the same species.</p>
<p>The <strong>Mt Fyffe forest</strong> data set also contains tree diameter measurements, but in this case there have been two surveys, so in order to add individual tree observations we need the mapping <code>individualOrganismLabel</code> to specify which column identifies each tree in each plot:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mtfyffe_dia</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##    DiameterID Plot Subplot                  Project EntryNo
## 17     119220 17 3       L FYFFE, MOUNT FOREST 1980      91
## 20     121700  6 4       I FYFFE, MOUNT FOREST 1980     154
## 29     121685  6 4       D FYFFE, MOUNT FOREST 1980     139
##    ItemCurrentIdentifier Identifier AliveState            MethodName
## 17                  5167       5167      Alive Quadrat tree diameter
## 20                  7778       7778      Alive Quadrat tree diameter
## 29                  7701       7701      Alive Quadrat tree diameter
##    Verbatim.Species TaxonID CurrentTaxonID NVSCode       NVSSpeciesName
## 17           COPLUC    2400           2400  COPLUC      Coprosma lucida
## 20           RUBCIS    2756           2756  RUBCIS      Rubus cissoides
## 29           PSEARB    2568           2568  PSEARB Pseudopanax arboreus
##    Diameter DiameterValueUnits AssociationNo Association ItemObsNote ItemID
## 17     7.90                 cm            NA                      NA  13431
## 20     2.90                 cm            NA                      NA  11093
## 29     4.60                 cm            NA                      NA  11049
##    ItemObsID ParentPlotID ParentPlotObsID PlotMethodID PlotObsID ProjectID
## 17    902441          229           52221        89460    145010       867
## 20    902572          217           52241        67343    149638       867
## 29    902750          217           52241        24783    149634       867
##    SampleMethodID PlotObsStartDate
## 17           4629       1980-02-07
## 20           4629       1980-02-07
## 29           4629       1980-02-07</code></pre>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plotName <span class="op">=</span> <span class="st">"Plot"</span>, subPlotName <span class="op">=</span> <span class="st">"Subplot"</span>, obsStartDate <span class="op">=</span> <span class="st">"PlotObsStartDate"</span>,
               taxonName <span class="op">=</span> <span class="st">"NVSSpeciesName"</span>, individualOrganismLabel <span class="op">=</span> <span class="st">"Identifier"</span>, 
               diameterMeasurement <span class="op">=</span> <span class="st">"Diameter"</span><span class="op">)</span></code></pre></div>
<p>Since the diameter measurement method is the same as before, we can directly run `addIndividualOrganismObservations()`` and inspect the result:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mtfyffe_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addIndividualOrganismObservations.html">addIndividualOrganismObservations</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span>, <span class="va">mtfyffe_dia</span>, 
                                  mapping <span class="op">=</span> <span class="va">mapping</span>,
                                  methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>diameterMeasurement <span class="op">=</span> <span class="st">"DBH/cm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'DBH/cm' added for 'diameterMeasurement'.
##  67 plot(s) parsed, 0 new added.
##  117 plot observation(s) parsed, 0 new added.
##  30 organism names(s) parsed, 30 new added.
##  0 taxon concept(s) parsed, 0 new added.
##  30 organism identitie(s) parsed, 30 new added.
##  725 individual organism(s) parsed, 725 new added.
##  1082 record(s) parsed, 1082 new individual organism observation(s) added.
##  105 individual organism observation(s) with missing diameter value(s) not added.</code></pre>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span>, <span class="st">"individualOrganismObservation"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##   plotName obsStartDate individualOrganismLabel organismIdentityName
## 1   17 3_L   1980-02-07                    5167      Coprosma lucida
## 2    6 4_I   1980-02-07                    7778      Rubus cissoides
## 3    6 4_D   1980-02-07                    7701 Pseudopanax arboreus
##   diameter_method diameter_value
## 1          DBH/cm            7.9
## 2          DBH/cm            2.9
## 3          DBH/cm            4.6</code></pre>
<p>Note that in this case the number of observations of individual trees is higher than the number of trees, because of the repeated measurements. Although we will not show it here in any example, it is possible to associate organism observations to particular heights where organisms are observed or to particular strata, by linking them to stratum observations in the same way as we did for aggregate organism observations.</p>
</div>
<div id="aggregate-organism-observations" class="section level3">
<h3 class="hasAnchor">
<a href="#aggregate-organism-observations" class="anchor"></a>Aggregate organism observations</h3>
<p>Aggregate organism observations include measurements that apply to a set of organisms collectively, normally all organisms of the same species identity. The most common examples are abundance values (e.g. cover) for species. Function <code><a href="../reference/addAggregateOrganismObservations.html">addAggregateOrganismObservations()</a></code> can be used to import such data into a VegX document. We first inspect the <strong>Mokihinui forest</strong> data frame <code>moki_tcv</code> to decide what information should be mapped:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">moki_tcv</span>,<span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##     TaxonCategoryValueID   Plot Subplot
## 920              4302767 LGM38h      NA
## 921              4302768 LGM38h      NA
## 922              4302769 LGM38h      NA
##                                         Project EntryNo      MethodName
## 920 MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011       1 Recce Inventory
## 921 MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011       1 Recce Inventory
## 922 MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011       1 Recce Inventory
##     Verbatim.Species TaxonID CurrentTaxonID NVSCode        NVSSpeciesName
## 920           DACCUP    1178           1178  DACCUP Dacrydium cupressinum
## 921           DACCUP    1178           1178  DACCUP Dacrydium cupressinum
## 922           DACCUP    1178           1178  DACCUP Dacrydium cupressinum
##       Tier TierDescription TierTechniqueName TierLower TierUpper
## 920 Tier 1          &gt; 25 m    Standard Recce        25      50.0
## 921 Tier 2       12 - 25 m    Standard Recce        12      25.0
## 922 Tier 6         &lt; 30 cm    Standard Recce         0       0.3
##     TierHeightUnits Category CategoryDescription  CategoryTechniqueName
## 920               m        3               6-25% Standard Recce (Allen)
## 921               m        3               6-25% Standard Recce (Allen)
## 922               m        1                 &lt;1% Standard Recce (Allen)
##     TaxonObsNote ParentPlotID ParentPlotObsID PlotMethodID PlotObsID ProjectID
## 920                    789183         1161780      1392859   1161780      2444
## 921                    789183         1161780      1392859   1161780      2444
## 922                    789183         1161780      1392859   1161780      2444
##     SampleMethodID TaxonObsID  TierID PlotObsStartDate
## 920          13405    7448485 2133018       2011-02-20
## 921          13405    7448485 2133019       2011-02-20
## 922          13405    7448485 2133023       2011-02-20</code></pre>
<p>As before, taxon names can be drawn from column <code>NVSSpeciesName</code>. Column <code>Tier</code> contains information about the stratum where species were recorded, whereas column <code>Category</code> contains cover values codified in a cover ordinal scale. First, we define a mapping for these variables as well as for plot and observation start date, which together specify a <em>plotObservation</em> (aggregate organism observations were not done in subplots for this data set).</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plotName <span class="op">=</span> <span class="st">"Plot"</span>, obsStartDate <span class="op">=</span> <span class="st">"PlotObsStartDate"</span>, 
               taxonName <span class="op">=</span> <span class="st">"NVSSpeciesName"</span>,
               stratumName <span class="op">=</span> <span class="st">"Tier"</span>, cover <span class="op">=</span> <span class="st">"Category"</span><span class="op">)</span></code></pre></div>
<p>In order to parse cover values, we could use a method of percent cover, but in this data set cover is specified using cover classes. Thus, we need to define an ordinal scale that can be used to interpret <code>Category</code> values; this can be done with function <code><a href="../reference/defineOrdinalScaleMethod.html">defineOrdinalScaleMethod()</a></code>:</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coverscale</span> <span class="op">=</span> <span class="fu"><a href="../reference/defineOrdinalScaleMethod.html">defineOrdinalScaleMethod</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Recce cover scale"</span>,
                   description <span class="op">=</span> <span class="st">"Recce recording method by Hurst/Allen"</span>,
                   subject <span class="op">=</span> <span class="st">"plant cover"</span>,
                   citation <span class="op">=</span> <span class="st">"Hurst, JM and Allen, RB. (2007) The Recce method for describing 
                               Zealand vegetation – Field protocols. Landcare Research, Lincoln."</span>,
                   codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"P"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span><span class="op">)</span>,
                   quantifiableCodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span><span class="op">)</span>,
                   breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">75</span>, <span class="fl">100</span><span class="op">)</span>,
                   midPoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">15</span>, <span class="fl">37.5</span>, <span class="fl">62.5</span>, <span class="fl">87.5</span><span class="op">)</span>,
                   definitions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Presence"</span>, <span class="st">"&lt;1%"</span>, <span class="st">"1-5%"</span>,<span class="st">"6-25%"</span>, <span class="st">"26-50%"</span>, 
                                   <span class="st">"51-75%"</span>, <span class="st">"76-100%"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>As the source data specifies taxon abundances within vegetation strata, we also need to supply information on how the strata are defined. The <strong>VegX R package</strong> provides three different ways of defining strata: by heights, by categories and using a mixed approach. This last option is used in the following code:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">moki_strataDef</span> <span class="op">=</span> <span class="fu"><a href="../reference/defineMixedStrata.html">defineMixedStrata</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Recce strata"</span>,
                   description <span class="op">=</span> <span class="st">"Standard Recce stratum definition"</span>,
                   citation <span class="op">=</span> <span class="st">"Hurst, JM and Allen, RB. (2007) The Recce method for describing 
                               Zealand vegetation – Field protocols. Landcare Research, Lincoln."</span>,
                   heightStrataBreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span>,<span class="fl">2.0</span>,<span class="fl">5</span>, <span class="fl">12</span>, <span class="fl">25</span>, <span class="fl">50</span><span class="op">)</span>,
                   heightStrataNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Tier "</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,
                   categoryStrataNames <span class="op">=</span> <span class="st">"Tier 7"</span>,
                   categoryStrataDefinition <span class="op">=</span> <span class="st">"Epiphytes"</span><span class="op">)</span></code></pre></div>
<p>Having the mapping, the cover scale and the stratum definition we can proceed to import species cover values by strata using function <code><a href="../reference/addAggregateOrganismObservations.html">addAggregateOrganismObservations()</a></code>:</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">moki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addAggregateOrganismObservations.html">addAggregateOrganismObservations</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="va">moki_tcv</span>, <span class="va">mapping</span>,
                        methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cover<span class="op">=</span><span class="va">coverscale</span><span class="op">)</span>,
                        stratumDefinition <span class="op">=</span> <span class="va">moki_strataDef</span><span class="op">)</span></code></pre></div>
<pre><code>##  1 additional aggregate organism measurements found: Category.
##  Measurement method 'Recce cover scale' added for 'cover'.
##  Stratum definition method 'Recce strata' added.
##  7 new stratum definitions added.
##  5 plot(s) parsed, 0 new added.
##  5 plot observation(s) parsed, 0 new added.
##  148 organism names(s) parsed, 121 new added.
##  148 organism identitie(s) parsed, 121 new added.
##  33 stratum observation(s) parsed, 33 new added.
##  582 record(s) parsed, 582 new aggregate organism observation(s) added.</code></pre>
<p>Note that the both the stratum definition and the cover scale contain <em>methods</em> that are added to the Veg-X document. The strata themselves are also added to the document (i.e. <em>stratum</em> elements). Other elements that are added are organism identities (i.e. taxon names), stratum observations (because species were observed while focusing on particular strata) and, finally, aggregate organism observation themselves. Less organism names and organism names have been added than those parsed, because the Veg-X document already contained some from individual organism observations. We can inspect the newly added taxon cover observations using:</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"aggregateOrganismObservation"</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##   plotName obsStartDate  organismIdentityName stratumName      agg_1_method
## 1   LGM38h   2011-02-20 Dacrydium cupressinum      Tier 1 Recce cover scale
## 2   LGM38h   2011-02-20 Dacrydium cupressinum      Tier 2 Recce cover scale
## 3   LGM38h   2011-02-20 Dacrydium cupressinum      Tier 6 Recce cover scale
##   agg_1_value
## 1           3
## 2           3
## 3           1</code></pre>
<p>The <strong>Mt Fyffe forest</strong> data set includes individual counts by species and stratum (i.e. another kind of aggregate organism observations) in a data frame <code>mtfyffe_counts</code>, which has a similar structure as <code>moki_tcv</code>, but with counts being in column <code>value</code>:</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mtfyffe_counts</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##   TaxonSimpleValueID Plot Subplot                  Project EntryNo
## 2            1496938 12 1       E FYFFE, MOUNT FOREST 1980      11
## 3            1496939 12 1       E FYFFE, MOUNT FOREST 1980      12
## 4            1496951 12 1       M FYFFE, MOUNT FOREST 1980      26
##        MethodName Verbatim.Species TaxonID CurrentTaxonID NVSCode
## 2 Quadrat sapling           PSECOL    2588           2588  PSECOL
## 3 Quadrat sapling           RUBCIS    2756           2756  RUBCIS
## 4 Quadrat sapling           PSECRA    2571           2571  PSECRA
##             NVSSpeciesName Tier TierDescription TierTechniqueName Value Units
## 2   Pseudowintera colorata   NA                                       1 count
## 3          Rubus cissoides   NA                                       1 count
## 4 Pseudopanax crassifolius   NA                                       1 count
##     MeasureName TaxonObsNote ParentPlotID ParentPlotObsID PlotMethodID
## 2 Sapling Count                       221           52256       508043
## 3 Sapling Count                       221           52256       508043
## 4 Sapling Count                       221           52256       420498
##   PlotObsID ProjectID SampleMethodID TaxonObsID TierID PlotObsStartDate
## 2    142900       867           3512    2185897     NA       1980-02-07
## 3    142900       867           3512    2185898     NA       1980-02-07
## 4    326011       867           3512    2185912     NA       1980-02-07</code></pre>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plotName <span class="op">=</span> <span class="st">"Plot"</span>, subPlotName <span class="op">=</span> <span class="st">"Subplot"</span>, obsStartDate <span class="op">=</span> <span class="st">"PlotObsStartDate"</span>, 
               taxonName <span class="op">=</span> <span class="st">"NVSSpeciesName"</span>, stratumName <span class="op">=</span> <span class="st">"Tier"</span>, counts <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span></code></pre></div>
<p>Analogously to the previous case, we need to specify a measurement method for counts, and in this case we can use function <code><a href="../reference/predefinedMeasurementMethod.html">predefinedMeasurementMethod()</a></code>:</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">countscale</span> <span class="op">=</span> <span class="fu"><a href="../reference/predefinedMeasurementMethod.html">predefinedMeasurementMethod</a></span><span class="op">(</span><span class="st">"Individual plant counts"</span><span class="op">)</span></code></pre></div>
<p>Then we also need to provide the strata definition, which is different from that of the previous data set. Here all strata are defined by height, so we can use a function called <code><a href="../reference/defineHeightStrata.html">defineHeightStrata()</a></code>:</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mtfyffe_strataDef</span> <span class="op">=</span> <span class="fu"><a href="../reference/defineHeightStrata.html">defineHeightStrata</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Standard seedling/sapling strata"</span>,
                              description <span class="op">=</span> <span class="st">"Seedling/sapling stratum definition"</span>,
                              heightBreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span>, <span class="fl">45</span>, <span class="fl">75</span>, <span class="fl">105</span>, <span class="fl">135</span>, <span class="fl">200</span><span class="op">)</span>,
                              strataNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,
                              strataDefinitions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0-15 cm"</span>, <span class="st">"16-45 cm"</span>, <span class="st">"46-75 cm"</span>, 
                                                    <span class="st">"76-105 cm"</span>, <span class="st">"106-135 cm"</span>, <span class="st">"&gt; 135 cm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now, we are ready to import the data:</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mtfyffe_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addAggregateOrganismObservations.html">addAggregateOrganismObservations</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span>, <span class="va">mtfyffe_counts</span>, <span class="va">mapping</span>,
                        methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>counts<span class="op">=</span><span class="va">countscale</span><span class="op">)</span>,
                        stratumDefinition <span class="op">=</span> <span class="va">mtfyffe_strataDef</span><span class="op">)</span></code></pre></div>
<pre><code>##  1 additional aggregate organism measurements found: Value.
##  Measurement method 'Individual plant counts' added for 'counts'.
##  Stratum definition method 'Standard seedling/sapling strata' added.
##  6 new stratum definitions added.
##  131 plot(s) parsed, 0 new added.
##  194 plot observation(s) parsed, 0 new added.
##  55 organism names(s) parsed, 30 new added.
##  55 organism identitie(s) parsed, 30 new added.
##  170 stratum observation(s) parsed, 170 new added.
##  533 record(s) parsed, 533 new aggregate organism observation(s) added.</code></pre>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span>, <span class="st">"aggregateOrganismObservation"</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##   plotName obsStartDate     organismIdentityName            agg_1_method
## 1   12 1_E   1980-02-07   Pseudowintera colorata Individual plant counts
## 2   12 1_E   1980-02-07          Rubus cissoides Individual plant counts
## 3   12 1_M   1980-02-07 Pseudopanax crassifolius Individual plant counts
##   agg_1_value stratumName
## 1           1        &lt;NA&gt;
## 2           1        &lt;NA&gt;
## 3           1        &lt;NA&gt;</code></pre>
<p>Again, this involves that elements of several kinds are added to our Veg-X document. The process for the <strong>Takitimu grassland</strong> data set is similar, but in this case, the observations are not organized by strata, and as abundance values we have frequency of occurrence.</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">taki_freq</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##   TaxonSimpleValueID            Plot Subplot                      Project
## 3            7514719 T2 2 (T2 2_TRA)      NA TAKITIMU GRASSLAND 1968-1969
## 6            7566591 T2 2 (T2 2_TRA)      NA TAKITIMU GRASSLAND 1968-1969
## 9            7583612 R3 1 (R3 1_TRA)      NA TAKITIMU GRASSLAND 1968-1969
##   EntryNo         MethodName Verbatim.Species TaxonID CurrentTaxonID NVSCode
## 3       0 Transect frequency             MOSS    2184           2184    MOSS
## 6       0 Transect frequency           SCHPAU    2843           2843  SCHPAU
## 9       0 Transect frequency           HELICH     843            843  HELICH
##         NVSSpeciesName TierDescription TierTechniqueName Value Units
## 3         Moss species              NA                NA    38     %
## 6 Schoenus pauciflorus              NA                NA     9     %
## 9  Helichrysum species              NA                NA     2     %
##            MeasureName TaxonObsNote ParentPlotID ParentPlotObsID PlotMethodID
## 3 Percentage Frequency           NA       781855         1153877      1386555
## 6 Percentage Frequency           NA       781855         1153877      1386555
## 9 Percentage Frequency           NA       781860         1153882      1385873
##   PlotObsID ProjectID SampleMethodID TaxonObsID TierID PlotObsStartDate
## 3   1153877       500          13184    7262934     NA       1968-02-07
## 6   1153877       500          13184    7262217     NA       1968-02-07
## 9   1153882       500          13184    7247662     NA       1968-02-07</code></pre>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plotName <span class="op">=</span> <span class="st">"Plot"</span>, obsStartDate <span class="op">=</span> <span class="st">"PlotObsStartDate"</span>, 
               taxonName <span class="op">=</span> <span class="st">"NVSSpeciesName"</span>, freq <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span></code></pre></div>
<p>Hence, we define the new measurement scale and call again <code><a href="../reference/addAggregateOrganismObservations.html">addAggregateOrganismObservations()</a></code>:</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">taki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addAggregateOrganismObservations.html">addAggregateOrganismObservations</a></span><span class="op">(</span><span class="va">taki_vegx</span>, <span class="va">taki_freq</span>, <span class="va">mapping</span>,
                        methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>freq<span class="op">=</span><span class="st">"Plant frequency/%"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  1 additional aggregate organism measurements found: Value.
##  Measurement method 'Plant frequency/%' added for 'freq'.
##  5 plot(s) parsed, 0 new added.
##  5 plot observation(s) parsed, 0 new added.
##  38 organism names(s) parsed, 38 new added.
##  38 organism identitie(s) parsed, 38 new added.
##  94 record(s) parsed, 94 new aggregate organism observation(s) added.</code></pre>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">taki_vegx</span>, <span class="st">"aggregateOrganismObservation"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##          plotName obsStartDate organismIdentityName      agg_1_method
## 1 T2 2 (T2 2_TRA)   1968-02-07         Moss species Plant frequency/%
## 2 T2 2 (T2 2_TRA)   1968-02-07 Schoenus pauciflorus Plant frequency/%
## 3 R3 1 (R3 1_TRA)   1968-02-07  Helichrysum species Plant frequency/%
##   agg_1_value
## 1          38
## 2           9
## 3           2</code></pre>
<p>As expected, no stratum definition nor stratum observations are added to the Veg-X document, but we still see the addition of organism names, organism identities and aggregate organism observations.</p>
<p>While aggregated organism observations are often related to strata, it is possible to indicate that measurements of cover of counts were done focusing on a particular height, by mapping to <em>heightMeasurement</em> instead of using <em>stratumName</em>.</p>
</div>
<div id="stratum-observations" class="section level3">
<h3 class="hasAnchor">
<a href="#stratum-observations" class="anchor"></a>Stratum observations</h3>
<p>In the previous subsections we stated that both individual and aggregate organism observations can be positioned in a particular vegetation stratum (e.g. the moss layer). However, one could imagine measurements that apply to the stratum itself, like the overall cover or basal area of all organisms in the stratum, regardless of their identity. Other common stratum measurements are those that define its vertical limits (e.g. at which height did the tree layer started?). Veg-X allows storing this information in elements <em>stratumObservation</em>. We showed that of this kind these were automatically created and added when dealing with aggregate taxon observations, but here we show how to add measurements that specifically refer to strata using function <code><a href="../reference/addStratumObservations.html">addStratumObservations()</a></code>.</p>
<p>To illustrate how to add stratum observations to a Veg-X document, we take again the <strong>Mokihinui forest</strong> data set as data source and inspect the data frame <code>moki_str</code>, which contains strata cover measurements:</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">moki_str</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##     TierID   Plot Subplot                                     Project
## 26 2133018 LGM38h      NA MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 27 2133019 LGM38h      NA MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 28 2133020 LGM38h      NA MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
##         MethodName   Tier TierDescription TierTechniqueName TierLower TierUpper
## 26 Recce Inventory Tier 1          &gt; 25 m    Standard Recce        25        50
## 27 Recce Inventory Tier 2       12 - 25 m    Standard Recce        12        25
## 28 Recce Inventory Tier 3        5 - 12 m    Standard Recce         5        12
##    TierHeightUnits CoverClass CoverClassDescription ParentPlotID
## 26               m          3                    NA       789183
## 27               m          3                    NA       789183
## 28               m          4                    NA       789183
##    ParentPlotObsID PlotObsID ProjectID SampleMethodID PlotMethodID
## 26         1161780   1161780      2444          13405      1392859
## 27         1161780   1161780      2444          13405      1392859
## 28         1161780   1161780      2444          13405      1392859
##    PlotObsStartDate
## 26       2011-02-20
## 27       2011-02-20
## 28       2011-02-20</code></pre>
<p>The data table also contains stratum height limits, although our definition of strata to import taxon cover data already contained height limits for most strata. We will assume that the data in <code>moki_str</code> indeed contains actual measurements and define the mapping accordingly:</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plotName <span class="op">=</span> <span class="st">"Plot"</span>, obsStartDate <span class="op">=</span> <span class="st">"PlotObsStartDate"</span>, stratumName <span class="op">=</span> <span class="st">"Tier"</span>,
               lowerLimitMeasurement <span class="op">=</span> <span class="st">"TierLower"</span>, upperLimitMeasurement <span class="op">=</span> <span class="st">"TierUpper"</span>,
               cover <span class="op">=</span> <span class="st">"CoverClass"</span><span class="op">)</span></code></pre></div>
<p>Both the cover ordinal scale and the strata definitions have been used before, so we do not need to redefine them. We do need, however, to create a definition of the method applying to height measurements, before calling <code><a href="../reference/addStratumObservations.html">addStratumObservations()</a></code>:</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">heightMethod</span> <span class="op">=</span> <span class="fu"><a href="../reference/predefinedMeasurementMethod.html">predefinedMeasurementMethod</a></span><span class="op">(</span><span class="st">"Stratum height/m"</span><span class="op">)</span>

<span class="va">moki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addStratumObservations.html">addStratumObservations</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="va">moki_str</span>, mapping <span class="op">=</span> <span class="va">mapping</span>,
                        methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>lowerLimitMeasurement <span class="op">=</span> <span class="va">heightMethod</span>,
                                       upperLimitMeasurement <span class="op">=</span> <span class="va">heightMethod</span>,
                                       cover<span class="op">=</span><span class="va">coverscale</span><span class="op">)</span>,
                        stratumDefinition <span class="op">=</span> <span class="va">moki_strataDef</span><span class="op">)</span></code></pre></div>
<pre><code>##  1 stratum measurement variables found.
##  Measurement method 'Stratum height/m' added for 'lowerLimitMeasurement'.
##  Measurement method 'Stratum height/m' for 'upperLimitMeasurement' already included.
##  Measurement method 'Recce cover scale' for 'cover' already included.
##  Stratum definition 'Recce strata' already included.
##  5 plot(s) parsed, 0 new added.
##  5 plot observation(s) parsed, 0 new added.
##  35 record(s) parsed, 2 new stratum observation(s) added.
##  7 measurement(s) with missing value(s) not added.</code></pre>
<p>Note that no new strata definitions are added, as they were already included when adding aggregate stratum observations. We do have some new stratum observations. The status of the stratum observations can be shown using:</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"stratumObservation"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##   plotName obsStartDate stratumName lowerLimit_method lowerLimit_value
## 1   LGM38h   2011-02-20      Tier 1  Stratum height/m               25
## 2   LGM38h   2011-02-20      Tier 2  Stratum height/m               12
## 3   LGM38h   2011-02-20      Tier 6  Stratum height/m                0
##   upperLimit_method upperLimit_value      str_1_method str_1_value
## 1  Stratum height/m             50.0 Recce cover scale           3
## 2  Stratum height/m             25.0 Recce cover scale           3
## 3  Stratum height/m              0.3 Recce cover scale           3</code></pre>
</div>
<div id="community-observations" class="section level3">
<h3 class="hasAnchor">
<a href="#community-observations" class="anchor"></a>Community observations</h3>
<p>Veg-X includes into elements <em>communityObservation</em> all biotic observations and measurements that are naturally defined at the plant community (or vegetation stand) level, such as basal area, species richness or stand age. Since our example source data sets did not include any of such measurements, we start by adding a column <code>BA</code> with simulated basal area values in the <code>moki_site</code> data frame using a Normal distribution:</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">moki_site</span><span class="op">$</span><span class="va">BA</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">moki_site</span><span class="op">)</span>, <span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Adding community observations requires, as usual, a mapping where in addition to mapping plots and surveys we can specify mappings for measurements defined at the community level:</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define mapping</span>
<span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plotName <span class="op">=</span> <span class="st">"Plot"</span>, subPlotName <span class="op">=</span> <span class="st">"Subplot"</span>,
               obsStartDate <span class="op">=</span> <span class="st">"PlotObsStartDate"</span>, basal_area <span class="op">=</span> <span class="st">"BA"</span><span class="op">)</span></code></pre></div>
<p>Of course, for each measurement we will need to provide a method that describes the measured subject, units, etc. Function <code><a href="../reference/addCommunityObservations.html">addCommunityObservations()</a></code> is used to add community observations to a VegX object:</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Add basal area measurements to the VegX object</span>
<span class="va">moki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addCommunityObservations.html">addCommunityObservations</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="va">moki_site</span>, mapping <span class="op">=</span> <span class="va">mapping</span>,
                        methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>basal_area <span class="op">=</span> <span class="st">"basal area"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'Basal area/m2*ha-1' added for 'basal_area'.
##  25 plot(s) parsed, 0 new plot(s) added.
##  25 plot observation(s) parsed, 0 new plot observation(s) added.
##  25 record(s) parsed, 25 new community observation(s) added.</code></pre>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Inspect the result</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"communityObservation"</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##    plotName obsStartDate      comm_1_method comm_1_value
## 1    LGM08r   2011-02-17 Basal area/m2*ha-1     3.567706
## 2 LGM08r_1Q   2011-02-17 Basal area/m2*ha-1    15.278754
## 3 LGM08r_2Q   2011-02-17 Basal area/m2*ha-1     6.139433</code></pre>
</div>
<div id="site-observations" class="section level3">
<h3 class="hasAnchor">
<a href="#site-observations" class="anchor"></a>Site observations</h3>
<p>Veg-X includes into elements <em>siteObservation</em> all observations and measurements that do not refer to vegetation itself, i.e. abiotic measurements, soil type classifications, etc. Since our example source data sets did not include any of such measurements, we created a column <code>pH</code> with constant values in the <code>moki_site</code> data frame. The function that allows adding site observations is <code><a href="../reference/addSiteObservations.html">addSiteObservations()</a></code> and the following code should be rather self-explanatory by now:</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plotName <span class="op">=</span> <span class="st">"Plot"</span>, subPlotName <span class="op">=</span> <span class="st">"Subplot"</span>, obsStartDate <span class="op">=</span> <span class="st">"PlotObsStartDate"</span><span class="op">)</span>
<span class="va">moki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addSiteObservations.html">addSiteObservations</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="va">moki_site</span>,
                         plotObservationMapping <span class="op">=</span> <span class="va">mapping</span>,
                         soilMeasurementMapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="st">"pH"</span><span class="op">)</span>,
                         soilMeasurementMethods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="st">"pH/0-14"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'pH/0-14' added for 'a'.
##  25 plot(s) parsed, 0 new plot(s) added.
##  25 plot observation(s) parsed, 0 new plot observation(s) added.
##  25 record(s) parsed, 25 new site observation(s) added.</code></pre>
<p>In contrast with other <code>add...</code> functions, ‘a’ is only used here in the context of of the <code><a href="../reference/addSiteObservations.html">addSiteObservations()</a></code> function (i.e., there will be no variable called ‘a’ in the Veg-X document). When displaying site observations, columns <code>soil_1_*</code>, <code>soil_2_*</code> only indicate the numbering of soil variables:</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"siteObservation"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##    plotName obsStartDate soil_1_method soil_1_value
## 1    LGM08r   2011-02-17       pH/0-14            7
## 2 LGM08r_1Q   2011-02-17       pH/0-14            7
## 3 LGM08r_2Q   2011-02-17       pH/0-14            7
## 4 LGM08r_3Q   2011-02-17       pH/0-14            7
## 5 LGM08r_4Q   2011-02-17       pH/0-14            7
## 6    LGM16l   2011-02-15       pH/0-14            7</code></pre>
<p>It is important to distinguish the subject of a method from the method itself. For example, subject would be pH measurement of upper soil solution, whereas a particular methods for this subject would be the measurement in water or measurement in 0.01 mol CaCl. In the former example we added variable ‘pH’ of the input data to the VegX document and defined the measurement method as <code>pH/0-14</code>, which simply specifies the measurement of pH (the subject) onto a 0-14 scale. Let’s look at its definition:</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/predefinedMeasurementMethod.html">predefinedMeasurementMethod</a></span><span class="op">(</span><span class="st">"pH/0-14"</span><span class="op">)</span></code></pre></div>
<pre><code>## An object of class "VegXMethodDefinition"
## Slot "name":
## [1] "pH/0-14"
## 
## Slot "description":
## [1] "pH scale from 0 to 14"
## 
## Slot "citationString":
## [1] ""
## 
## Slot "DOI":
## [1] ""
## 
## Slot "subject":
## [1] "pH"
## 
## Slot "attributeType":
## [1] "quantitative"
## 
## Slot "attributes":
## $`1`
## $`1`$type
## [1] "quantitative"
## 
## $`1`$unit
## [1] NA
## 
## $`1`$lowerLimit
## [1] 0
## 
## $`1`$upperLimit
## [1] 14</code></pre>
</div>
<div id="surface-cover-observations" class="section level3">
<h3 class="hasAnchor">
<a href="#surface-cover-observations" class="anchor"></a>Surface cover observations</h3>
<p>Surface cover observations are measurements of the percentage of the plot’s surface that is covered (i.e. when projected onto the ground) by different surface types, such as rocks, bare soil, vegetation, etc. Veg-X allows defining surface types as <em>surfaceType</em> elements, and storing cover values for them in <em>surfaceCoverObservation</em> elements. We use the <strong>Mt Fyffe forest</strong> data set to illustrate how this kind of observations are added to a Veg-X document. First we inspect table <code>mtfyffe_groundcover</code> and define a mapping:</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mtfyffe_groundcover</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##    PlotGroundCoverID Plot Subplot                  Project PlotGroundCover
## 14              6157  6 4      NA FYFFE, MOUNT FOREST 1980      Vegetation
## 17              4176 17 3      NA FYFFE, MOUNT FOREST 1980      Vegetation
## 21              1353 14 2      NA FYFFE, MOUNT FOREST 1980      Vegetation
##                     TechniqueName           MeasureName Value ParentPlotID
## 14 Standard Ground Cover Estimate Ground Cover Category    20          217
## 17 Standard Ground Cover Estimate Ground Cover Category    20          229
## 21 Standard Ground Cover Estimate Ground Cover Category    20          226
##    ParentPlotObsID PlotObsID ProjectID PlotObsStartDate
## 14           52241     52241       867       1980-02-07
## 17           52221     52221       867       1980-02-07
## 21           52261     52261       867       1980-02-07</code></pre>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plotName <span class="op">=</span> <span class="st">"Plot"</span>, obsStartDate <span class="op">=</span> <span class="st">"PlotObsStartDate"</span>,
               surfaceName <span class="op">=</span> <span class="st">"PlotGroundCover"</span>, coverMeasurement <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span></code></pre></div>
<p>In this case, cover values are specified as percent cover of ground surface, so we need to define an appropriate method:</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coverMethod</span> <span class="op">=</span> <span class="fu"><a href="../reference/predefinedMeasurementMethod.html">predefinedMeasurementMethod</a></span><span class="op">(</span><span class="st">"Surface cover/%"</span><span class="op">)</span></code></pre></div>
<p>We inspect the surface types used in the data set and call function <code><a href="../reference/defineSurfaceTypes.html">defineSurfaceTypes()</a></code> as we have done previously for strata:</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">mtfyffe_groundcover</span><span class="op">$</span><span class="va">PlotGroundCover</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Vegetation"   "Moss"         "Litter"       "Exposed Soil" "Rock"</code></pre>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">surfaceTypes</span> <span class="op">=</span> <span class="fu"><a href="../reference/defineSurfaceTypes.html">defineSurfaceTypes</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Default surface types"</span>,
                     description <span class="op">=</span> <span class="st">"Five surface categories"</span>,
                     surfaceNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vegetation"</span>, <span class="st">"Moss"</span>, <span class="st">"Litter"</span>, <span class="st">"Exposed Soil"</span>, 
                                      <span class="st">"Rock"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We can now import surface cover observations using function <code><a href="../reference/addSurfaceCoverObservations.html">addSurfaceCoverObservations()</a></code>:</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mtfyffe_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addSurfaceCoverObservations.html">addSurfaceCoverObservations</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span>, <span class="va">mtfyffe_groundcover</span>, <span class="va">mapping</span>,
                                <span class="va">coverMethod</span>, <span class="va">surfaceTypes</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'Surface cover/%' added for 'coverMeasurement'.
##  Surface type definition method 'Default surface types' added.
##  5 new surface type definitions added.
##  4 plot(s) parsed, 0 new added.
##  8 plot observation(s) parsed, 0 new added.
##  40 record(s) parsed, 40 new surface cover observation(s) added.</code></pre>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span>, <span class="st">"surfaceCoverObservation"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##   plotObservationID plotName obsStartDate surfaceTypeID surfaceName cover_attID
## 1                 1      6 4   1980-02-07             1  Vegetation           8
## 2                 4     17 3   1980-02-07             1  Vegetation           8
## 3                 3     14 2   1980-02-07             1  Vegetation           8
## 4                 2     12 1   1980-02-07             1  Vegetation           8
## 5                 1      6 4   1980-02-07             2        Moss           8
## 6                 3     14 2   1980-02-07             2        Moss           8
##      cover_method cover_value
## 1 Surface cover/%          20
## 2 Surface cover/%          20
## 3 Surface cover/%          20
## 4 Surface cover/%          20
## 5 Surface cover/%          20
## 6 Surface cover/%          20</code></pre>
<p>Analogously to the case of strata, the function added surface type definitions to the Veg-X document, in addition to adding the cover values, themselves.</p>
<p>The <strong>Takitimu grassland</strong> data set also includes surface cover observations, although the surface types are slightly different:</p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">taki_groundcover</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##    PlotGroundCoverID            Plot Subplot                      Project
## 26            396242 R3 1 (R3 1_TRA)      NA TAKITIMU GRASSLAND 1968-1969
## 27            396243 R3 1 (R3 1_TRA)      NA TAKITIMU GRASSLAND 1968-1969
## 28            396244 R3 1 (R3 1_TRA)      NA TAKITIMU GRASSLAND 1968-1969
##    PlotGroundCover                  TechniqueName           MeasureName Value
## 26          Litter Standard Ground Cover Estimate Ground Cover Category    25
## 27            Rock Standard Ground Cover Estimate Ground Cover Category    25
## 28      Vegetation Standard Ground Cover Estimate Ground Cover Category    25
##    ParentPlotID ParentPlotObsID PlotObsID ProjectID PlotObsStartDate
## 26       781860         1153882   1153882       500       1968-02-07
## 27       781860         1153882   1153882       500       1968-02-07
## 28       781860         1153882   1153882       500       1968-02-07</code></pre>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">taki_groundcover</span><span class="op">$</span><span class="va">PlotGroundCover</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Litter"           "Rock"             "Vegetation"       "Erosion Pavement"
## [5] "Soil"</code></pre>
<p>Therefore, we must define a new set of surface types before calling function <code><a href="../reference/addSurfaceCoverObservations.html">addSurfaceCoverObservations()</a></code>:</p>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">surfaceTypes</span> <span class="op">=</span> <span class="fu"><a href="../reference/defineSurfaceTypes.html">defineSurfaceTypes</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Default surface types"</span>,
                     description <span class="op">=</span> <span class="st">"Five surface categories"</span>,
                     surfaceNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vegetation"</span>, <span class="st">"Soil"</span>, <span class="st">"Erosion Pavement"</span>, <span class="st">"Litter"</span>,
                                      <span class="st">"Rock"</span><span class="op">)</span><span class="op">)</span>

<span class="va">taki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/addSurfaceCoverObservations.html">addSurfaceCoverObservations</a></span><span class="op">(</span><span class="va">taki_vegx</span>, <span class="va">taki_groundcover</span>, <span class="va">mapping</span>,
                                <span class="va">coverMethod</span>, <span class="va">surfaceTypes</span><span class="op">)</span></code></pre></div>
<pre><code>##  Measurement method 'Surface cover/%' added for 'coverMeasurement'.
##  Surface type definition method 'Default surface types' added.
##  5 new surface type definitions added.
##  5 plot(s) parsed, 0 new added.
##  5 plot observation(s) parsed, 0 new added.
##  17 record(s) parsed, 17 new surface cover observation(s) added.</code></pre>
</div>
</div>
<div id="combining-and-harmonizing-veg-x-documents" class="section level2">
<h2 class="hasAnchor">
<a href="#combining-and-harmonizing-veg-x-documents" class="anchor"></a>Combining and harmonizing Veg-X documents</h2>
<p>One of the purposes of importing data into Veg-X, is the possibility to combine and harmonize documents from different sources. In this section we illustrate how documents should be merged, and some functions that can be used to harmonize their contents.</p>
<div id="adding-unique-identifiers" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-unique-identifiers" class="anchor"></a>Adding unique identifiers</h3>
<p>When combining VegX objects from different sources it is important to pay attention to plot names, because plots from two different sources may have been given the same name while in fact they correspond to different sampled areas. To combine two vegetation sources while avoiding confusion in plot identity one should use <strong>plot unique identifiers</strong>, i.e. sub-element <em>plotUniqueIdentifier</em> of <em>plot</em>. When populating a Veg-X object from a single source data set, unique identifiers are not normally available nor needed, and the functions that add observations to the object will only look at <em>plotName</em> to identifying plots uniquely. However, when merging VegX objects unique identifiers should be defined, and two plots should be considered to be the same only if both their plot name and unique identifier have the same values in both plots. While less critical than plot unique identifiers, the Veg-X standard also allows unique identifiers for plot observations, via the sub-element <em>plotObservationUniqueIdentifier</em> of <em>plotObservation</em>.</p>
<p>The VegX package provides two ways to supply unique identifiers. The function <code><a href="../reference/addPlotObservations.html">addPlotObservations()</a></code> allows specifying mappings for both <em>plotUniqueIdentifier</em> and <em>plotObservationUniqueIdentifier</em>:</p>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>projectTitle <span class="op">=</span> <span class="st">"Project"</span>, plotName <span class="op">=</span> <span class="st">"Plot"</span>, subPlotName <span class="op">=</span> <span class="st">"Subplot"</span>,
               obsStartDate <span class="op">=</span> <span class="st">"PlotObsStartDate"</span>, obsEndDate <span class="op">=</span> <span class="st">"PlotObsStopDate"</span>,
               plotUniqueIdentifier <span class="op">=</span> <span class="st">"PlotID"</span>, plotObservationUniqueIdentifier <span class="op">=</span> <span class="st">"PlotObsID"</span><span class="op">)</span>
<span class="va">vegx_ids</span> <span class="op">=</span> <span class="fu"><a href="../reference/addPlotObservations.html">addPlotObservations</a></span><span class="op">(</span><span class="fu"><a href="../reference/newVegX.html">newVegX</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">moki_site</span>, mapping <span class="op">=</span> <span class="va">mapping</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">vegx_ids</span>, <span class="st">"plot"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##    plotName plotUniqueIdentifier relatedPlotName plotRelationship
## 1    LGM08r               789033            &lt;NA&gt;             &lt;NA&gt;
## 2 LGM08r_1Q               789034          LGM08r          subplot
## 3 LGM08r_2Q               789035          LGM08r          subplot</code></pre>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">vegx_ids</span>, <span class="st">"plotObservation"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##    plotName obsStartDate obsEndDate plotObservationUniqueIdentifier
## 1    LGM08r   2011-02-17 2011-02-17                         1161630
## 2 LGM08r_1Q   2011-02-17 2011-02-17                         1161631
## 3 LGM08r_2Q   2011-02-17 2011-02-17                         1161632
##                                  projectTitle
## 1 MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 2 MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011
## 3 MOKIHINUI HYDRO PROPOSAL - LOWER GORGE 2011</code></pre>
<p>We could use function <code><a href="../reference/addPlotObservations.html">addPlotObservations()</a></code> to define unique identifiers because these were available from our source data. Note however, that IDs coming from NVS are only unique within the context of this data bank. In cases the source data does not include unique identifiers or those available may not be unique in all situations, one can generate <strong>universally unique identifiers</strong> (or replace the current identifiers) using function <code><a href="../reference/fillUniqueIdentifiers.html">fillUniqueIdentifiers()</a></code>:</p>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">moki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/fillUniqueIdentifiers.html">fillUniqueIdentifiers</a></span><span class="op">(</span>target <span class="op">=</span> <span class="va">moki_vegx</span>, element <span class="op">=</span> <span class="st">"plot"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"plot"</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##    plotName                 plotUniqueIdentifier     shape    length_method
## 1    LGM08r 39939b9e-8359-404b-849d-fc217aa7c9e9 rectangle Plot dimension/m
## 2 LGM08r_1Q 406a40a5-2576-404e-a45f-e94b2f235ac1 rectangle Plot dimension/m
## 3 LGM08r_2Q 6d01d667-0eb5-4f85-b068-5fa97dd31167 rectangle Plot dimension/m
##   length_value     width_method width_value   coordX   coordY
## 1           20 Plot dimension/m          20 172.1407 -41.5417
## 2           10 Plot dimension/m          10       NA       NA
## 3           10 Plot dimension/m          10       NA       NA
##             spatialReference elevation_method elevation_value  slope_method
## 1 +proj=longlat +datum=WGS84      Elevation/m              95 Slope/degrees
## 2                       &lt;NA&gt;             &lt;NA&gt;              NA          &lt;NA&gt;
## 3                       &lt;NA&gt;             &lt;NA&gt;              NA          &lt;NA&gt;
##   slope_value  aspect_method aspect_value relatedPlotName plotRelationship
## 1          40 Aspect/degrees          360            &lt;NA&gt;             &lt;NA&gt;
## 2          NA           &lt;NA&gt;           NA          LGM08r          subplot
## 3          NA           &lt;NA&gt;           NA          LGM08r          subplot</code></pre>
<p>A UUID (Universal Unique Identifier) is a 128-bit number used to uniquely identify some object or entity. When generated according to the standard methods, UUIDs are for practical purposes unique, without depending for their uniqueness on a central registration authority or coordination between the parties generating them, unlike most other numbering schemes. While the probability that a UUID will be duplicated is not zero, it is close enough to zero to be negligible. If we are interested in merging different documents it is important to ensure that unique identifiers are defined for plots. Function <code><a href="../reference/fillUniqueIdentifiers.html">fillUniqueIdentifiers()</a></code> generates UUIDs by calling function <code>UUIDgenerate()</code> from the <strong>R package uuid</strong>.</p>
<p>As we did for Mokihinui VegX object, we generate universally unique identifiers for the other two VegX objects:</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mtfyffe_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/fillUniqueIdentifiers.html">fillUniqueIdentifiers</a></span><span class="op">(</span>target <span class="op">=</span> <span class="va">mtfyffe_vegx</span>, element <span class="op">=</span> <span class="st">"plot"</span><span class="op">)</span>
<span class="va">taki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/fillUniqueIdentifiers.html">fillUniqueIdentifiers</a></span><span class="op">(</span>target <span class="op">=</span> <span class="va">taki_vegx</span>, element <span class="op">=</span> <span class="st">"plot"</span><span class="op">)</span></code></pre></div>
</div>
<div id="updating-taxon-nomenclature" class="section level3">
<h3 class="hasAnchor">
<a href="#updating-taxon-nomenclature" class="anchor"></a>Updating taxon nomenclature</h3>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"organismIdentity"</span><span class="op">)</span>,<span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code>##                identityName     originalOrganismName taxon
## 1       Weinmannia racemosa      Weinmannia racemosa  TRUE
## 2      Coprosma grandifolia     Coprosma grandifolia  TRUE
## 3           Cyathea smithii          Cyathea smithii  TRUE
## 4  Dacrycarpus dacrydioides Dacrycarpus dacrydioides  TRUE
## 5       Dicksonia squarrosa      Dicksonia squarrosa  TRUE
## 6   Pseudowintera axillaris  Pseudowintera axillaris  TRUE
## 7      Quintinia acutifolia     Quintinia acutifolia  TRUE
## 8           Coprosma lucida          Coprosma lucida  TRUE
## 9      Melicytus ramiflorus     Melicytus ramiflorus  TRUE
## 10         Myrsine salicina         Myrsine salicina  TRUE</code></pre>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">moki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/setPreferredTaxonNomenclature.html">setPreferredTaxonNomenclature</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="va">moki_lookup</span>,
                   <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>originalOrganismName <span class="op">=</span> <span class="st">"NVSSpeciesName"</span>, preferredTaxonName <span class="op">=</span> <span class="st">"PreferredSpeciesName"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Preferred taxon name was set on 149 organism identities.
##  Preferred taxon name is now different than original organism name on 22 organism identities.
##  21 new organism name(s) added.</code></pre>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="st">"organismIdentity"</span><span class="op">)</span>
<span class="va">a</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">identityName</span><span class="op">!=</span> <span class="va">a</span><span class="op">$</span><span class="va">originalOrganismName</span><span class="op">)</span>,<span class="op">]</span></code></pre></div>
<pre><code>##                    identityName     originalOrganismName taxon
## 13             Fuscospora fusca         Nothofagus fusca  TRUE
## 15          Fuscospora truncata      Nothofagus truncata  TRUE
## 22            Podocarpus laetus        Podocarpus hallii  TRUE
## 28         Lophozonia menziesii     Nothofagus menziesii  TRUE
## 36           Carex horizontalis        Uncinia rupestris  TRUE
## 37          Veronica leiophylla          Hebe leiophylla  TRUE
## 41             Carex corynoidea          Uncinia clavata  TRUE
## 45               Carex uncinata         Uncinia uncinata  TRUE
## 55         Phlegmariurus varius           Huperzia varia  TRUE
## 61      Dendrobium cunninghamii      Winika cunninghamii  TRUE
## 66                Carex species          Uncinia species  TRUE
## 67   Notogrammitis billardierei   Grammitis billardierei  TRUE
## 68  Hymenophyllum nephrophyllum    Trichomanes reniforme  TRUE
## 73         Veronica salicifolia         Hebe salicifolia  TRUE
## 76            Melicytus species     Hymenanthera species  TRUE
## 87          Erigeron bilbaoanus         Conyza bilbaoana  TRUE
## 90             Veronica lyallii         Parahebe lyallii  TRUE
## 95          Leontodon saxatilis   Leontodon taraxacoides  TRUE
## 97          Lolium arundinaceum Schedonorus arundinaceus  TRUE
## 113  Notogrammitis heterophylla Ctenopteris heterophylla  TRUE
## 127       Austroderia richardii     Cortaderia richardii  TRUE
## 136             Coprosma dumosa       Coprosma tayloriae  TRUE
##              preferredTaxonName
## 13             Fuscospora fusca
## 15          Fuscospora truncata
## 22            Podocarpus laetus
## 28         Lophozonia menziesii
## 36           Carex horizontalis
## 37          Veronica leiophylla
## 41             Carex corynoidea
## 45               Carex uncinata
## 55         Phlegmariurus varius
## 61      Dendrobium cunninghamii
## 66                Carex species
## 67   Notogrammitis billardierei
## 68  Hymenophyllum nephrophyllum
## 73         Veronica salicifolia
## 76            Melicytus species
## 87          Erigeron bilbaoanus
## 90             Veronica lyallii
## 95          Leontodon saxatilis
## 97          Lolium arundinaceum
## 113  Notogrammitis heterophylla
## 127       Austroderia richardii
## 136             Coprosma dumosa</code></pre>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mtfyffe_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/setPreferredTaxonNomenclature.html">setPreferredTaxonNomenclature</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span>, <span class="va">mtfyffe_lookup</span>,
                   <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>originalOrganismName <span class="op">=</span> <span class="st">"NVSSpeciesName"</span>, preferredTaxonName <span class="op">=</span> <span class="st">"PreferredSpeciesName"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Preferred taxon name was set on 59 organism identities.
##  Preferred taxon name is now different than original organism name on 13 organism identities.
##  9 new organism name(s) added.</code></pre>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">mtfyffe_vegx</span>, <span class="st">"organismIdentity"</span><span class="op">)</span>
<span class="va">a</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">identityName</span><span class="op">!=</span> <span class="va">a</span><span class="op">$</span><span class="va">originalOrganismName</span><span class="op">)</span>,<span class="op">]</span></code></pre></div>
<pre><code>##                 identityName       originalOrganismName taxon
## 6            Coprosma dumosa         Coprosma tayloriae  TRUE
## 9       Coprosma grandifolia         Coprosma australis  TRUE
## 12         Podocarpus laetus          Podocarpus hallii  TRUE
## 15          Fuscospora fusca           Nothofagus fusca  TRUE
## 19     Prumnopitys taxifolia        Podocarpus spicatus  TRUE
## 30       Veronica leiophylla            Hebe gracillima  TRUE
## 37  Blechnum novae-zelandiae           Blechnum capense  TRUE
## 41            Carex uncinata           Uncinia uncinata  TRUE
## 42           Raukaua simplex        Pseudopanax simplex  TRUE
## 44     Microsorum pustulatum Phymatosorus diversifolius  TRUE
## 48 Polystichum neozelandicum      Polystichum richardii  TRUE
## 49              Carex healyi             Uncinia scabra  TRUE
## 58     Veronica brachysiphon          Hebe brachysiphon  TRUE
##           preferredTaxonName
## 6            Coprosma dumosa
## 9       Coprosma grandifolia
## 12         Podocarpus laetus
## 15          Fuscospora fusca
## 19     Prumnopitys taxifolia
## 30       Veronica leiophylla
## 37  Blechnum novae-zelandiae
## 41            Carex uncinata
## 42           Raukaua simplex
## 44     Microsorum pustulatum
## 48 Polystichum neozelandicum
## 49              Carex healyi
## 58     Veronica brachysiphon</code></pre>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">taki_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/setPreferredTaxonNomenclature.html">setPreferredTaxonNomenclature</a></span><span class="op">(</span><span class="va">taki_vegx</span>, <span class="va">taki_lookup</span>,
                   <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>originalOrganismName <span class="op">=</span> <span class="st">"NVSSpeciesName"</span>, preferredTaxonName <span class="op">=</span> <span class="st">"PreferredSpeciesName"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Preferred taxon name was set on 38 organism identities.
##  Preferred taxon name is now different than original organism name on 5 organism identities.
##  5 new organism name(s) added.</code></pre>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">taki_vegx</span>, <span class="st">"organismIdentity"</span><span class="op">)</span>
<span class="va">a</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">identityName</span><span class="op">!=</span> <span class="va">a</span><span class="op">$</span><span class="va">originalOrganismName</span><span class="op">)</span>,<span class="op">]</span></code></pre></div>
<pre><code>##               identityName    originalOrganismName taxon
## 9   Veronica lycopodioides      Hebe lycopodioides  TRUE
## 14 Rytidosperma setifolium Notodanthonia setifolia  TRUE
## 15        Zotovia colensoi      Petriella colensoi  TRUE
## 17        Veronica species            Hebe species  TRUE
## 32        Lobelia angulata         Pratia angulata  TRUE
##         preferredTaxonName
## 9   Veronica lycopodioides
## 14 Rytidosperma setifolium
## 15        Zotovia colensoi
## 17        Veronica species
## 32        Lobelia angulata</code></pre>
</div>
<div id="merging-two-veg-x-documents" class="section level3">
<h3 class="hasAnchor">
<a href="#merging-two-veg-x-documents" class="anchor"></a>Merging two Veg-X documents</h3>
<p>Function <code><a href="../reference/mergeVegX.html">mergeVegX()</a></code> is used to merge two Veg-X documents into a single one. This function puts all the input elements into the same containers and, whenever elements are considered to be the same, they are merged. Each element kind has its own way to determine when two instances refer to the same entity. For example, two plots will be considered to be equal if they have the same plot name and, if defined, they have the same <em>plotUniqueIdentifier</em>. By default, however, plots and organism identities are not merged. This is a security measure to avoid plots with the same name but from different sources to be identified as equal. A call to <code><a href="../reference/mergeVegX.html">mergeVegX()</a></code> to merge the <code>mtfyffe_vegx</code> and <code>taki_vegx</code> VegX objects produces the following output:</p>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">comb_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/mergeVegX.html">mergeVegX</a></span><span class="op">(</span><span class="va">moki_vegx</span>, <span class="va">mtfyffe_vegx</span><span class="op">)</span></code></pre></div>
<pre><code>##  Final number of party(ies): 1. Data pooled for 0 party(ies).
##  Final number of literature citations: 1. Data pooled for 0 citation(s).
##  Final number of methods: 15. Data pooled for 5 method(s).
##  Final number of attributes: 20.
##  Final number of strata: 13. Data pooled for 0 strata.
##  Final number of surface types: 5. Data pooled for 0 surface types.
##  Final number of organism names: 209. Data pooled for 30 organism name(s).
##  Final number of taxon concepts: 0. Data pooled for 0 organism name(s).
##  Final number of organism identities: 209. Data pooled for 0 organism identitie(s).
##  Final number of projects: 3. Data pooled for 0 project(s).
##  Final number of plots: 190. Data pooled for 0 plot(s).
##  Final number of individual organisms: 1368. Data pooled for 0 individual organism(s).
##  Final number of plot observations: 351. Data pooled for 0 plot observation(s).
##  Final number of stratum observations: 205. Data pooled for 0 stratum observation(s).
##  Final number of individual organism observations: 1725. Data pooled for 0 individual organism observation(s).
##  Final number of aggregate organism observations: 1115. Data pooled for 0 aggregate organism observation(s).
##  Final number of site observations: 25. Data pooled for 0 site observation(s).
##  Final number of community observations: 25. Data pooled for 0 community observation(s).
##  Final number of surface cover observations: 40. Data pooled for 0 surface cover observation(s).</code></pre>
<p>Plots were all kept separately because <code>allowMergePlots = FALSE</code> by default. However, in this case the plots had all different names and unique identifiers, so even if we had set <code>allowMergePlots = TRUE</code>, they would have been all kept separately. The objects to be merged had shared methods, so the function identifies them as equal and avoids repetitions. The decisions to merge (i.e. pool) information of other elements can be interpreted similarly. A special case concerns <em>organismName</em> vs. <em>organismIdentity</em>. Note that some organism names were merged, but identities were not. While merging equal names is always safe, merging identities should be done with extreme caution, because two data sets may have employed the same taxon name but with different taxon concepts. Therefore, by default <code><a href="../reference/mergeVegX.html">mergeVegX()</a></code> does not merge organism identities. If we want to specify that identities can be merged (when considered equal) we can set parameter <code>allowMergeOrganismIdentities = TRUE</code>:</p>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># comb_vegx = mergeVegX(moki_vegx, mtfyffe_vegx, allowMergeOrganismIdentities = TRUE)</span></code></pre></div>
<p>In this second output, there are the number of merges in <em>organismName</em> than <em>organismIdentity</em>, as the equal names have been forced to mean equal identity.</p>
<p>Note that function <code><a href="../reference/mergeVegX.html">mergeVegX()</a></code> can also be used to merge two documents that refer to the same data source, i.e. if one has imported different parts of the same source data into different Veg-X objects. In this case the user should specify <code>allowMergePlots = TRUE</code>.</p>
<div id="merging-rules" class="section level4">
<h4 class="hasAnchor">
<a href="#merging-rules" class="anchor"></a>Merging rules</h4>
<p>Users of the VegX package should be aware that <strong>organism identities are by default kept separate</strong> when merging Veg-X objects. If the user chooses to merge identities, the decision to actually merge two given organism identities is complex, depending on both nomenclature and taxon concepts. Let ‘1’ and ‘2’ be two organism identities being compared. If original taxon concepts (i.e. element <em>originalIdentificationConcept</em>) are missing for both of them, the following table explains decision according to nomenclature and, in case of merging, the nomenclature of the resulting identity (asterisk indicates that a warning will be raised by the merging function):</p>
<table class="table">
<thead><tr class="header">
<th>Case</th>
<th>Orig.1</th>
<th>Pref.1</th>
<th>Orig.2</th>
<th>Pref.2</th>
<th>Merge</th>
<th>Orig.Res.</th>
<th>Pref.Res.</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>X</td>
<td>-</td>
<td>Y</td>
<td>-</td>
<td>No</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>2</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>-</td>
<td>Yes</td>
<td>X</td>
<td>-</td>
</tr>
<tr class="odd">
<td>3</td>
<td>X</td>
<td>Y</td>
<td>X</td>
<td>-</td>
<td>No*</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>4</td>
<td>X</td>
<td>Y</td>
<td>Y</td>
<td>-</td>
<td>Yes</td>
<td>-</td>
<td>Y</td>
</tr>
<tr class="odd">
<td>5</td>
<td>X</td>
<td>Y</td>
<td>X</td>
<td>Z</td>
<td>No*</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>6</td>
<td>X</td>
<td>Y</td>
<td>V</td>
<td>Z</td>
<td>No</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="odd">
<td>7</td>
<td>X</td>
<td>Y</td>
<td>Z</td>
<td>Y</td>
<td>Yes</td>
<td>-</td>
<td>Y</td>
</tr>
<tr class="even">
<td>8</td>
<td>X</td>
<td>Y</td>
<td>X</td>
<td>Y</td>
<td>Yes</td>
<td>X</td>
<td>Y</td>
</tr>
<tr class="odd">
<td>9</td>
<td>-</td>
<td>X</td>
<td>-</td>
<td>Y</td>
<td>No</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>10</td>
<td>-</td>
<td>X</td>
<td>-</td>
<td>X</td>
<td>Yes</td>
<td>-</td>
<td>X</td>
</tr>
<tr class="odd">
<td>11</td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>X</td>
<td>Yes</td>
<td>-</td>
<td>X</td>
</tr>
<tr class="even">
<td>12</td>
<td>X</td>
<td>-</td>
<td>-</td>
<td>Y</td>
<td>No</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>In the more general case where original taxon concepts may have been specified for identity ‘1’, identity ‘2’ or both, the following table explains the decision to merge or not those organism identities, depending on the value of their taxon concepts and whether merging is possible according to nomenclature (asterisk indicates that a warning will be raised by the merging function):</p>
<table class="table">
<thead><tr class="header">
<th>Case</th>
<th>Nom. Merge?</th>
<th>Tax.Con.1</th>
<th>Tax.Con.2</th>
<th>Merge</th>
<th>Tax.Con. Res.</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>No</td>
<td>-</td>
<td>-</td>
<td>No</td>
<td>-</td>
</tr>
<tr class="even">
<td>2</td>
<td>No</td>
<td>X</td>
<td>-</td>
<td>No</td>
<td>-</td>
</tr>
<tr class="odd">
<td>3</td>
<td>No</td>
<td>X</td>
<td>Y</td>
<td>No</td>
<td>-</td>
</tr>
<tr class="even">
<td>4</td>
<td>No</td>
<td>X</td>
<td>X</td>
<td>No*</td>
<td>-</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Yes</td>
<td>-</td>
<td>-</td>
<td>Yes</td>
<td>-</td>
</tr>
<tr class="even">
<td>6</td>
<td>Yes</td>
<td>X</td>
<td>-</td>
<td>Yes</td>
<td>-</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Yes</td>
<td>X</td>
<td>Y</td>
<td>No*</td>
<td>-</td>
</tr>
<tr class="even">
<td>8</td>
<td>Yes</td>
<td>X</td>
<td>X</td>
<td>Yes</td>
<td>X</td>
</tr>
</tbody>
</table>
</div>
<div id="adding-observations-to-vegx-objects-that-have-identities-defined" class="section level4">
<h4 class="hasAnchor">
<a href="#adding-observations-to-vegx-objects-that-have-identities-defined" class="anchor"></a>Adding observations to VegX objects that have identities defined</h4>
<p>The general workflow when working with the VegX package is: (1) Create a new VegX document; (2) Add plot data and plot observations; (3) perform nomenclature corrections; (4) Merge documents. However, it could happen that user’s attempt to add observations to a VegX object that already contains identities, possibly with nomenclatural revisions and associated taxon concepts. When adding organism observations to VegX objects, the add function assumes that the name supplied is an <em>originalOrganismName</em> and it applies the same rules explained to determine whether they refer to the same identity and, if not, then a new organism identity will be created. For example, even if there is a match between the supplied name and the original organism name of an existing identity, a new identity will be created if the original taxon concept has been asserted for the existing one, because there is no way to check that the two organisms involved have indeed the same identity. If existing entity does not have an original taxon concept, then the decision to create or not new organism identities will follow the nomenclature rules of the table above.</p>
</div>
</div>
<div id="transforming-quantitative-scales" class="section level3">
<h3 class="hasAnchor">
<a href="#transforming-quantitative-scales" class="anchor"></a>Transforming quantitative scales</h3>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">heightMethod2</span> <span class="op">=</span> <span class="fu"><a href="../reference/predefinedMeasurementMethod.html">predefinedMeasurementMethod</a></span><span class="op">(</span><span class="st">"Stratum height/cm"</span><span class="op">)</span>
<span class="va">trans_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/transformQuantitativeScale.html">transformQuantitativeScale</a></span><span class="op">(</span><span class="va">comb_vegx</span>, <span class="st">"Stratum height/m"</span>, <span class="va">heightMethod2</span>,
                               <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="fl">10</span><span class="op">)</span><span class="op">}</span>, replaceValues <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##  Target method: 'Stratum height/m'
##  Number of quantitative attributes: 1
##  Measurement method 'Stratum height/cm' added.
##  70 transformation(s) were applied on stratum observations.</code></pre>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">trans_vegx</span>, <span class="st">"stratumObservation"</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##   plotName obsStartDate stratumName lowerLimit_method lowerLimit_value
## 1   LGM38h   2011-02-20      Tier 1 Stratum height/cm              250
## 2   LGM38h   2011-02-20      Tier 2 Stratum height/cm              120
## 3   LGM38h   2011-02-20      Tier 6 Stratum height/cm                0
##   upperLimit_method upperLimit_value      str_1_method str_1_value
## 1 Stratum height/cm              500 Recce cover scale           3
## 2 Stratum height/cm              250 Recce cover scale           3
## 3 Stratum height/cm                3 Recce cover scale           3</code></pre>
</div>
<div id="transforming-ordinal-scales" class="section level3">
<h3 class="hasAnchor">
<a href="#transforming-ordinal-scales" class="anchor"></a>Transforming ordinal scales</h3>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">percentScale</span> <span class="op">=</span> <span class="fu"><a href="../reference/predefinedMeasurementMethod.html">predefinedMeasurementMethod</a></span><span class="op">(</span><span class="st">"Plant cover/%"</span><span class="op">)</span>
<span class="va">trans_vegx</span> <span class="op">=</span> <span class="fu"><a href="../reference/transformOrdinalScale.html">transformOrdinalScale</a></span><span class="op">(</span><span class="va">comb_vegx</span>, <span class="st">"Recce cover scale"</span>, <span class="va">percentScale</span><span class="op">)</span></code></pre></div>
<pre><code>##  Target method: 'Recce cover scale'
##  Number of attributes: 7
##  Number of quantifiable attributes with midpoints: 6
##  Limits of the new attribute: [0, 100]
##  Measurement method 'Plant cover/%' added.
##  531 transformation(s) were applied on aggregate organism observations.
##  28 transformation(s) were applied on stratum observations.</code></pre>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/showElementTable.html">showElementTable</a></span><span class="op">(</span><span class="va">trans_vegx</span>, <span class="st">"stratumObservation"</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##   plotName obsStartDate stratumName lowerLimit_method lowerLimit_value
## 1   LGM38h   2011-02-20      Tier 1  Stratum height/m               25
## 2   LGM38h   2011-02-20      Tier 2  Stratum height/m               12
## 3   LGM38h   2011-02-20      Tier 6  Stratum height/m                0
##   upperLimit_method upperLimit_value      str_1_method str_1_value
## 1  Stratum height/m             50.0 Recce cover scale           3
## 2  Stratum height/m             25.0 Recce cover scale           3
## 3  Stratum height/m              0.3 Recce cover scale           3
##    str_2_method str_2_value
## 1 Plant cover/%          15
## 2 Plant cover/%          15
## 3 Plant cover/%          15</code></pre>
<p>head(showElementTable(, “organismIdentity”))</p>
</div>
</div>
<div id="writing-and-reading-veg-x-documents" class="section level2">
<h2 class="hasAnchor">
<a href="#writing-and-reading-veg-x-documents" class="anchor"></a>Writing and reading Veg-X documents</h2>
<p>The <strong>Veg-X exchange standard</strong> is currently implemented as an <strong>XML schema</strong> (but other physical implementations of the standard could be possible). The VegX package provides functions <code>writeVegX()</code> and <code>readVegX()</code> that are used, respectively, to write and read XML files with Veg-X documents. An advantage of XML is that it is text that can be read and understood by humans, but its disadvantage is that files tend to be very large, because of the redundancy of text. One possibility to overcome this is to compress XML files (into zip or tar.gz files) for more efficient storage. However, compressing XML files does not avoid the problem that writing/reading XML files can be slow in large data sets.</p>
<p>An alternative to XML that users can employ is to directly save and read Veg-X documents as R objects, using functions <code><a href="https://rdrr.io/r/base/readRDS.html">saveRDS()</a></code>and <code><a href="https://rdrr.io/r/base/readRDS.html">readRDS()</a></code>. This option is fast and will produce much smaller files. The only drawback of saving R objects can arise if the S4 definition of Veg-X documents is changed in future versions of the package. We tried to avoid this potential problem by defining S4 Veg-X objects as lists of the main elements, without defining the internal structure of each main element. If the version of the standard is changed, functions to convert R objects from old to new versions of the standard should be made available to avoid losing backwards compatibility, in the same way that function <code>readVegX()</code> should be modified to allow reading XML documents formed following old versions of the standard.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Miquel De Caceres.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
